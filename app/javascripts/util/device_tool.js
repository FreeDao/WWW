/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 1.0.7 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/**
 * @license Cookie v1.0.1
 * https://github.com/seajs/dew/tree/master/src/cookie
 */

/**
 * @license RequireJS text 0.27.1 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

var DeviceCenterWidget;(function(){if(!DeviceCenterWidget||!DeviceCenterWidget.requirejs){DeviceCenterWidget?require=DeviceCenterWidget:DeviceCenterWidget={};var requirejs,require,define;(function(){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function mixin(e,t,n){for(var r in t)!(r in empty)&&(!(r in e)||n)&&(e[r]=t[r]);return req}function makeError(e,t,n){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n&&(r.originalError=n),r}function configurePackageDir(e,t,n){var r,i,s;for(r=0;s=t[r];r++)s=typeof s=="string"?{name:s}:s,i=s.location,n&&(!i||i.indexOf("/")!==0&&i.indexOf(":")===-1)&&(i=n+"/"+(i||s.name)),e[s.name]={name:s.name,location:i||s.name,main:(s.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}function jQueryHoldReady(e,t){e.holdReady?e.holdReady(t):t?e.readyWait+=1:e.ready(!0)}function newContext(e){function y(e){var t,n;for(t=0;n=e[t];t++)if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}function b(e,t){var n,i;return e&&e.charAt(0)==="."&&(t?(r.pkgs[t]?t=[t]:(t=t.split("/"),t=t.slice(0,t.length-1)),e=t.concat(e.split("/")),y(e),i=r.pkgs[n=e[0]],e=e.join("/"),i&&e===n+"/"+i.main&&(e=n)):e.indexOf("./")===0&&(e=e.substring(2))),e}function w(e,n){var r=e?e.indexOf("!"):-1,i=null,s=n?n.name:null,a=e,f,l,c;return r!==-1&&(i=e.substring(0,r),e=e.substring(r+1,e.length)),i&&(i=b(i,s)),e&&(i?(c=u[i],c&&c.normalize?f=c.normalize(e,function(e){return b(e,s)}):f=b(e,s)):(f=b(e,s),l=o[f],l||(l=t.nameToUrl(e,null,n),o[f]=l))),{prefix:i,name:f,parentMap:n,url:l,originalName:a,fullName:i?i+"!"+(f||""):f}}function E(){var e=!0,t=r.priorityWait,n,i;if(t){for(i=0;n=t[i];i++)if(!a[n]){e=!1;break}e&&delete r.priorityWait}return e}function S(e,t,n){return function(){var r=aps.call(arguments,0),i;return n&&isFunction(i=r[r.length-1])&&(i.__requireJsBuild=!0),r.push(t),e.apply(null,r)}}function x(e,n,r){var i=S(r||t.require,e,n);return mixin(i,{nameToUrl:S(t.nameToUrl,e),toUrl:S(t.toUrl,e),defined:S(t.requireDefined,e),specified:S(t.requireSpecified,e),isBrowser:req.isBrowser}),i}function T(e){t.paused.push(e)}function N(e){var n,i,s,o,a,c=e.callback,h=e.map,d=h.fullName,g=e.deps,y=e.listeners,b;if(c&&isFunction(c)){if(r.catchError.define)try{i=req.execCb(d,e.callback,g,u[d])}catch(E){s=E}else i=req.execCb(d,e.callback,g,u[d]);d&&(b=e.cjsModule,b&&b.exports!==undefined&&b.exports!==u[d]?i=u[d]=e.cjsModule.exports:i===undefined&&e.usingExports?i=u[d]:(u[d]=i,v[d]&&(m[d]=!0)))}else d&&(i=u[d]=c,v[d]&&(m[d]=!0));f[e.id]&&(delete f[e.id],e.isDone=!0,t.waitCount-=1,t.waitCount===0&&(l=[])),delete p[d],req.onResourceLoad&&!e.placeholder&&req.onResourceLoad(t,h,e.depArray);if(s)return o=(d?w(d).url:"")||s.fileName||s.sourceURL,a=s.moduleTree,s=makeError("defineerror",'Error evaluating module "'+d+'" at location "'+o+'":\n'+s+"\nfileName:"+o+"\nlineNumber: "+(s.lineNumber||s.line),s),s.moduleName=d,s.moduleTree=a,req.onError(s);for(n=0;c=y[n];n++)c(i);return undefined}function C(e,t){return function(n){e.depDone[t]||(e.depDone[t]=!0,e.deps[t]=n,e.depCount-=1,e.depCount||N(e))}}function k(e,i){var s=i.map,o=s.fullName,f=s.name,l=d[e]||(d[e]=u[e]),c;if(i.loading)return;i.loading=!0,c=function(e){i.callback=function(){return e},N(i),a[i.id]=!0,n()},c.fromText=function(e,n){var r=useInteractive;a[e]=!1,t.scriptCount+=1,t.fake[e]=!0,r&&(useInteractive=!1),req.exec(n),r&&(useInteractive=!0),t.completeLoad(e)},o in u?c(u[o]):l.load(f,x(s.parentMap,!0,function(e,n){var r=[],o,u,a;for(o=0;u=e[o];o++)a=w(u,s.parentMap),e[o]=a.fullName,a.prefix||r.push(e[o]);return i.moduleDeps=(i.moduleDeps||[]).concat(r),t.require(e,n)}),c,r)}function L(e){f[e.id]||(f[e.id]=e,l.push(e),t.waitCount+=1)}function A(e){this.listeners.push(e)}function O(e,t){var n=e.fullName,r=e.prefix,i=r?d[r]||(d[r]=u[r]):null,o,f,l,v;return n&&(o=p[n]),o||(f=!0,o={id:(r&&!i?h++ +"__p@:":"")+(n||"__r@"+h++),map:e,depCount:0,depDone:[],depCallbacks:[],deps:[],listeners:[],add:A},s[o.id]=!0,n&&(!r||d[r])&&(p[n]=o)),r&&!i?(v=w(r),r in u&&!u[r]&&(delete u[r],delete c[v.url]),l=O(v,!0),l.add(function(t){var n=w(e.originalName,e.parentMap),r=O(n,!0);o.placeholder=!0,r.add(function(e){o.callback=function(){return e},N(o)})})):f&&t&&(a[o.id]=!1,T(o),L(o)),o}function M(e,n,i,o){var l=w(e,o),h=l.name,p=l.fullName,d=O(l),g=d.id,y=d.deps,b,E,S,T,k;if(p){if(p in u||a[g]===!0||p==="jquery"&&r.jQuery&&r.jQuery!==i().fn.jquery)return;s[g]=!0,a[g]=!0,p==="jquery"&&i&&jQueryCheck(i())}d.depArray=n,d.callback=i;for(b=0;b<n.length;b++)E=n[b],E&&(E=w(E,h?l:o),S=E.fullName,T=E.prefix,n[b]=S,S==="require"?y[b]=x(l):S==="exports"?(y[b]=u[p]={},d.usingExports=!0):S==="module"?d.cjsModule=k=y[b]={id:h,uri:h?t.nameToUrl(h,null,o):undefined,exports:u[p]}:!(S in u)||S in f||p in v&&!(p in v&&m[S])?(p in v&&(v[S]=!0,delete u[S],c[E.url]=!1),d.depCount+=1,d.depCallbacks[b]=C(d,b),O(E,!0).add(d.depCallbacks[b])):y[b]=u[S]);d.depCount?L(d):N(d)}function _(e){M.apply(null,e)}function D(e,t){var n=e.map.fullName,r=e.depArray,i=!0,s,o,u,l;if(e.isDone||!n||!a[n])return l;if(t[n])return e;t[n]=!0;if(r){for(s=0;s<r.length;s++){o=r[s];if(!a[o]&&!reservedDependencies[o]){i=!1;break}u=f[o];if(u&&!u.isDone&&a[o]){l=D(u,t);if(l)break}}i||(l=undefined,delete t[n])}return l}function P(e,t){var n=e.map.fullName,r=e.depArray,i,s,o,l,c,h;if(e.isDone||!n||!a[n])return undefined;if(n){if(t[n])return u[n];t[n]=!0}if(r)for(i=0;i<r.length;i++)s=r[i],s&&(l=w(s).prefix,l&&(c=f[l])&&P(c,t),o=f[s],o&&!o.isDone&&a[s]&&(h=P(o,t),e.depCallbacks[i](h)));return u[n]}function H(){var e=r.waitSeconds*1e3,i=e&&t.startTime+e<(new Date).getTime(),s="",o=!1,u=!1,c=[],h,d,v,m,g,y;if(t.pausedCount>0)return undefined;if(r.priorityWait){if(!E())return undefined;n()}for(d in a)if(!(d in empty)){o=!0;if(!a[d])if(i)s+=d+" ";else{u=!0;if(d.indexOf("!")===-1){c=[];break}y=p[d]&&p[d].moduleDeps,y&&c.push.apply(c,y)}}if(!o&&!t.waitCount)return undefined;if(i&&s)return v=makeError("timeout","Load timeout for modules: "+s),v.requireType="timeout",v.requireModules=s,v.contextName=t.contextName,req.onError(v);if(u&&c.length)for(h=0;m=f[c[h]];h++)if(g=D(m,{})){P(g,{});break}if(!i&&(u||t.scriptCount))return(isBrowser||isWebWorker)&&!checkLoadedTimeoutId&&(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,H()},50)),undefined;if(t.waitCount){for(h=0;m=l[h];h++)P(m,{});t.paused.length&&n(),checkLoadedDepth<5&&(checkLoadedDepth+=1,H())}return checkLoadedDepth=0,req.checkReadyState(),undefined}var t,n,r={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},catchError:{}},i=[],s={require:!0,exports:!0,module:!0},o={},u={},a={},f={},l=[],c={},h=0,p={},d={},v={},m={},g=0;return jQueryCheck=function(e){if(!t.jQuery){var n=e||(typeof jQuery!="undefined"?jQuery:null);if(n){if(r.jQuery&&n.fn.jquery!==r.jQuery)return;if("holdReady"in n||"readyWait"in n)t.jQuery=n,_(["jquery",[],function(){return jQuery}]),t.scriptCount&&(jQueryHoldReady(n,!0),t.jQueryIncremented=!0)}}},n=function(){var e,n,s,o,u,f,l;t.takeGlobalQueue(),g+=1,t.scriptCount<=0&&(t.scriptCount=0);while(i.length){f=i.shift();if(f[0]===null)return req.onError(makeError("mismatch","Mismatched anonymous define() module: "+f[f.length-1]));_(f)}if(!r.priorityWait||E())while(t.paused.length){u=t.paused,t.pausedCount+=u.length,t.paused=[];for(o=0;e=u[o];o++)n=e.map,s=n.url,l=n.fullName,n.prefix?k(n.prefix,e):!c[s]&&!a[l]&&(req.load(t,l,s),s.indexOf("empty:")!==0&&(c[s]=!0));t.startTime=(new Date).getTime(),t.pausedCount-=u.length}return g===1&&H(),g-=1,undefined},t={contextName:e,config:r,defQueue:i,waiting:f,waitCount:0,specified:s,loaded:a,urlMap:o,urlFetched:c,scriptCount:0,defined:u,paused:[],pausedCount:0,plugins:d,needFullExec:v,fake:{},fullExec:m,managerCallbacks:p,makeModuleMap:w,normalize:b,configure:function(e){var i,s,o,u,a,f;e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/"),i=r.paths,o=r.packages,u=r.pkgs,mixin(r,e,!0);if(e.paths){for(s in e.paths)s in empty||(i[s]=e.paths[s]);r.paths=i}a=e.packagePaths;if(a||e.packages){if(a)for(s in a)s in empty||configurePackageDir(u,a[s],s);e.packages&&configurePackageDir(u,e.packages),r.pkgs=u}e.priority&&(f=t.requireWait,t.requireWait=!1,n(),t.require(e.priority),n(),t.requireWait=f,r.priorityWait=e.priority),(e.deps||e.callback)&&t.require(e.deps||[],e.callback)},requireDefined:function(e,t){return w(e,t).fullName in u},requireSpecified:function(e,t){return w(e,t).fullName in s},require:function(r,i,s){var o,a,f;if(typeof r=="string")return isFunction(i)?req.onError(makeError("requireargs","Invalid require call")):req.get?req.get(t,r,i):(o=r,s=i,f=w(o,s),a=f.fullName,a in u?u[a]:req.onError(makeError("notloaded","Module name '"+f.fullName+"' has not been loaded yet for context: "+e)));(r&&r.length||i)&&M(null,r,i,s);if(!t.requireWait)while(!t.scriptCount&&t.paused.length)n();return t.require},takeGlobalQueue:function(){globalDefQueue.length&&(apsp.apply(t.defQueue,[t.defQueue.length-1,0].concat(globalDefQueue)),globalDefQueue=[])},completeLoad:function(e){var r;t.takeGlobalQueue();while(i.length){r=i.shift();if(r[0]===null){r[0]=e;break}if(r[0]===e)break;_(r),r=null}r?_(r):_([e,[],e==="jquery"&&typeof jQuery!="undefined"?function(){return jQuery}:null]),req.isAsync&&(t.scriptCount-=1),n(),req.isAsync||(t.scriptCount-=1)},toUrl:function(e,n){var r=e.lastIndexOf("."),i=null;return r!==-1&&(i=e.substring(r,e.length),e=e.substring(0,r)),t.nameToUrl(e,i,n)},nameToUrl:function(e,n,r){var i,s,o,u,a,f,l,c,h=t.config;e=b(e,r&&r.fullName);if(req.jsExtRegExp.test(e))c=e+(n?n:"");else{i=h.paths,s=h.pkgs,a=e.split("/");for(f=a.length;f>0;f--){l=a.slice(0,f).join("/");if(i[l]){a.splice(0,f,i[l]);break}if(o=s[l]){e===o.name?u=o.location+"/"+o.main:u=o.location,a.splice(0,f,u);break}}c=a.join("/")+(n||".js"),c=(c.charAt(0)==="/"||c.match(/^\w+:/)?"":h.baseUrl)+c}return h.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+h.urlArgs):c}},t.jQueryCheck=jQueryCheck,t.resume=n,t}function getInteractiveScript(){var e,t,n;if(interactiveScript&&interactiveScript.readyState==="interactive")return interactiveScript;e=document.getElementsByTagName("script");for(t=e.length-1;t>-1&&(n=e[t]);t--)if(n.readyState==="interactive")return interactiveScript=n;return null}var version="1.0.7",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/require\(\s*["']([^'"\s]+)["']\s*\)/g,currDirRegExp=/^\.\//,jsSuffixRegExp=/\.js$/,ostring=Object.prototype.toString,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",empty={},contexts={},globalDefQueue=[],interactiveScript=null,checkLoadedDepth=0,useInteractive=!1,reservedDependencies={require:!0,module:!0,exports:!0},req,cfg={},currentlyAddingScript,s,head,baseElement,scripts,script,src,subPath,mainScript,dataMain,globalI,ctx,jQueryCheck,checkLoadedTimeoutId;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t){var n=defContextName,r,i;return!isArray(e)&&typeof e!="string"&&(i=e,isArray(t)?(e=t,t=arguments[2]):e=[]),i&&i.context&&(n=i.context),r=contexts[n]||(contexts[n]=newContext(n)),i&&r.configure(i),r.require(e,t)},req.config=function(e){return req(e)},require||(require=req),req.toUrl=function(e){return contexts[defContextName].toUrl(e)},req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,s=req.s={contexts:contexts,skipAsync:{}},req.isAsync=req.isBrowser=isBrowser,isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){req.resourcesReady(!1),e.scriptCount+=1,req.attach(n,e,t),e.jQuery&&!e.jQueryIncremented&&(jQueryHoldReady(e.jQuery,!0),e.jQueryIncremented=!0)},define=function(e,t,n){var r,i;return typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n]),undefined},define.amd={multiversion:!0,plugins:!0,jQuery:!0},req.exec=function(text){return eval(text)},req.execCb=function(e,t,n,r){return t.apply(r,n)},req.addScriptToDom=function(e){currentlyAddingScript=e,baseElement?head.insertBefore(e,baseElement):head.appendChild(e),currentlyAddingScript=null},req.onScriptLoad=function(e){var t=e.currentTarget||e.srcElement,n,r,i;if(e.type==="load"||t&&readyRegExp.test(t.readyState))interactiveScript=null,n=t.getAttribute("data-requirecontext"),r=t.getAttribute("data-requiremodule"),i=contexts[n],contexts[n].completeLoad(r),t.detachEvent&&!isOpera?t.detachEvent("onreadystatechange",req.onScriptLoad):t.removeEventListener("load",req.onScriptLoad,!1)},req.attach=function(e,t,n,r,i,o){var u;return isBrowser?(r=r||req.onScriptLoad,u=t&&t.config&&t.config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),u.type=i||t&&t.config.scriptType||"text/javascript",u.charset="utf-8",u.async=!s.skipAsync[e],t&&u.setAttribute("data-requirecontext",t.contextName),u.setAttribute("data-requiremodule",n),u.attachEvent&&!isOpera?(useInteractive=!0,o?u.onreadystatechange=function(e){u.readyState==="loaded"&&(u.onreadystatechange=null,u.attachEvent("onreadystatechange",r),o(u))}:u.attachEvent("onreadystatechange",r)):u.addEventListener("load",r,!1),u.src=e,o||req.addScriptToDom(u),u):(isWebWorker&&(importScripts(e),t.completeLoad(n)),null)};if(isBrowser){scripts=document.getElementsByTagName("script");for(globalI=scripts.length-1;globalI>-1&&(script=scripts[globalI]);globalI--){head||(head=script.parentNode);if(dataMain=script.getAttribute("data-main")){cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript.replace(jsSuffixRegExp,"")),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain];break}}}req.checkReadyState=function(){var e=s.contexts,t;for(t in e)if(!(t in empty)&&e[t].waitCount)return;req.resourcesReady(!0)},req.resourcesReady=function(e){var t,n,r;req.resourcesDone=e;if(req.resourcesDone){t=s.contexts;for(r in t)r in empty||(n=t[r],n.jQueryIncremented&&(jQueryHoldReady(n.jQuery,!1),n.jQueryIncremented=!1))}},req.pageLoaded=function(){document.readyState!=="complete"&&(document.readyState="complete")},isBrowser&&document.addEventListener&&(document.readyState||(document.readyState="loading",window.addEventListener("load",req.pageLoaded,!1))),req(cfg),req.isAsync&&typeof setTimeout!="undefined"&&(ctx=s.contexts[cfg.context||defContextName],ctx.requireWait=!0,setTimeout(function(){ctx.requireWait=!1,ctx.scriptCount||ctx.resume(),req.checkReadyState()},0))})(),DeviceCenterWidget.requirejs=requirejs,DeviceCenterWidget.require=require,DeviceCenterWidget.define=define}})(),DeviceCenterWidget.define("requireLib",function(){}),DeviceCenterWidget.define("lib/event/custevent",[],function(){var e={bind:function(e,t,n){var r=this._callbacks||(this._callbacks={}),i=r[e]||(r[e]=[]);return i.push([t,n]),this},unbind:function(e,t){var n;if(!e)this._callbacks={};else if(n=this._callbacks)if(!t)n[e]=[];else{var r=n[e];if(!r)return this;for(var i=0,s=r.length;i<s;i++)if(r[i]&&t===r[i][0]){r[i]=null;break}}return this},trigger:function(e){var t,n,r,i,s,o=2;if(!(n=this._callbacks))return this;while(o--){r=o?e:"all";if(t=n[r])for(var u=0,a=t.length;u<a;u++)if(!(i=t[u]))t.splice(u,1),u--,a--;else{s=o?Array.prototype.slice.call(arguments,1):arguments;if(i[0].apply(i[1]||this,s)===!1)break}}return this}};return e}),DeviceCenterWidget.define("lib/event/eventproxy",["lib/event/custevent"],function(e){var t=function(){var t=this;this.add=function(){return e.bind.apply(t,arguments),this},this.remove=function(){return e.unbind.apply(t,arguments),this},this.addOnce=function(e,n,r){var i=this;return t.add(e,function(){return t.remove(e,arguments.callee),n.apply(i,arguments)},r),this},this.fire=function(n){var r=Array.prototype.slice.call(arguments,1),i=n.split(":"),s=i.length,o=s;for(;o>0;o--)e.trigger.apply(t,[i.slice(0,o).join(":")].concat(r));return this},this.fireAsync=function(){var e=arguments;return setTimeout(function(){t.fire.apply(t,e)},0),this}};return t.attachTo=function(e){var n=new t;return e.publish=n.fire,e.publishAsync=n.fireAsync,e.subscribe=n.add,e.subscribeOnce=n.addOnce,e.unsubscribe=n.remove,e},t}),DeviceCenterWidget.define("lib/states/statesmachine",[],function(){var e=Array.prototype.slice,t=/^(?:=([\w\-]+))?(?:@([\w\-]+))/,n=function(e){this._actionTransitionFunctions={},this._currentState=null,this._context=e||this};n.prototype.run=function(e){return this._enterState(e),this},n.prototype.addActionTransition=function(e){var t=e.state,n=e.event,r=this._parseTransition(e.transition||e.callback||e.action);return this._actionTransitionFunctions[t]||(this._actionTransitionFunctions[t]={}),this._actionTransitionFunctions[t][n]=r,this},n.prototype.addEntryFunction=function(e){var t=e.state,n=e.entry||e.callback||e.action;return this._actionTransitionFunctions[t]||(this._actionTransitionFunctions[t]={}),this._actionTransitionFunctions[t].__entry=n,this},n.prototype.addGuardFunction=function(e){var t=e.state,n=e.guard||e.callback||e.action;return this._actionTransitionFunctions[t]||(this._actionTransitionFunctions[t]={}),this._actionTransitionFunctions[t].__guard=n,this},n.prototype.addExitFunction=function(e){var t=e.state,n=e.exit||e.callback||e.action;return this._actionTransitionFunctions[t]||(this._actionTransitionFunctions[t]={}),this._actionTransitionFunctions[t].__exit=n,this},n.prototype.defer=function(t){var n=this,r=e.call(arguments,1);return setTimeout(function(){t.apply(n._context,r)},0),this},n.prototype._parseTransition=function(n){var s=this;return r(n)?n:i(n)?(n=n.match(t),n&&n[2]?n[1]?function(){return s.doActionTransition.apply(s,[n[2],n[1]].concat(e.call(arguments)))}:function(){return n[2]}:(o('Illegal transition expression, it should be like "@state" or "=event@state"'),null)):null},n.prototype._enterState=function(e,t){var n,r,i,s;s=this._currentState,functions=this._actionTransitionFunctions[e],functions?(s&&(i=this._actionTransitionFunctions[s].__exit,i&&i.call(this._context,e,t)),n=functions.__guard,!n||n.call(this._context,s,t)?(r=functions.__entry,this._currentState=e,r&&r.call(this._context,s,t)):o("Can't access to State: ",e," from State: ",s," when ",t)):this.undefinedState.call(this._context,e,s,t)},n.prototype.doActionTransition=function(t,n){return this._actionTransitionFunctions[t][n].call(this._context,e.call(arguments,2))},n.prototype.handleEvent=function(t){var n,r;return n=this._actionTransitionFunctions[this._currentState][t],n?(r=n.apply(this._context,e.call(arguments,1)),this._currentState!==r&&this._enterState(r,t)):this.unexpectedEvent.call(this._context,this._currentState,t),this},n.prototype.unexpectedEvent=function(e,t){o("Event: ",t," is unexpected @",e)},n.prototype.undefinedState=function(e,t,n){o("State: ",e,"hasn't been registered! AFTER ",t," WHEN ",n)};var r=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},i=function(e){return!!(e===""||e&&e.charCodeAt&&e.substr)},s=function(){return!0},o=function(){throw new Error(e.call(arguments).join(""))};return n}),DeviceCenterWidget.define("config",[],function(){var e="https:",t=encodeURIComponent(window.location.href.replace(/^https:/,"http:")),n=encodeURIComponent(window.location.href.replace(/^http:/,"https:")),r="/my/devices",i="/my/pushed_apps";return{user:{SIGNIN_COOKIE:"wdj_auth",CURRENT_DEVICE_COOKIE:"c_cdid",IGNORE_NODEVICE:"c_ind"},service:{ACCOUNT_URL:e+"//account.wandoujia.com/v1/user/",APPPUSH_URL:e+"//apppush.wandoujia.com/apppush",ONLINE_URL:"http://apppush.wandoujia.com/apppush/online",OFFLINE_PUSH_URL:"/offlinepush/push",OFFLINE_CLEAR_URL:"/offlinepush/clear",OFFLINE_LIST_URL:"/offlinepush/list"},page:{MANAGEMENT:r,PUSHED_APPS:i},base:{SIGNIN_URL:e+"//www.wandoujia.com/account/web.html?callback="+t+"#login",SIGNUP_URL:e+"//www.wandoujia.com/account/web.html?callback="+t+"#register",SIGNOUT_URL:e+"//www.wandoujia.com/account/web.html?callback="+t+"#logout",DEFAULT_DEVICE_ICON:"http://static.wandoujia.com/files/devices_2/wdj/wdj-default-small.png"},notifier:{TIP_FADE_DURATION:500,TIP_HIDE_TIMEOUT:5e3,TIP_SHOWN_DURATION:5500}}}),DeviceCenterWidget.define("util",[],function(){var e=jQuery,t={},n=Object.prototype.toString;return t.each=function(){return e.each.apply(e,arguments)},t.filter=function(){return e.grep.apply(e,arguments)},t.map=function(){return e.map.apply(e,arguments)},t.extend=function(){var n=t.toArray(arguments);return t.isBoolean(n[n.length-1])&&n.unshift(n.pop()),e.extend.apply(e,n)},t.trim=function(){return e.trim.apply(e,arguments)},t.bind=function(){return e.proxy.apply(e,arguments)},t.toArray=function(){return e.makeArray.apply(e,arguments)},t.isBoolean=function(e){return e===!0||e===!1||n.call(e)=="[object Boolean]"},t.isFunction=function(e){return n.call(e)=="[object Function]"},t.isArray=Array.isArray||function(e){return n.call(e)=="[object Array]"},t.isObject=function(e){return e===Object(e)},t.isString=function(e){return n.call(e)=="[object String]"},t.isNull=function(e){return e===null},t.isUndefined=function(e){return e===void 0},t.format=function(e,t){var n=arguments;return e.replace(/\{(\d+)\}/ig,function(e,t){return n[t*1+1]||""})},t.refreshWindow=function(){window.location=window.location.toString().replace(window.location.hash||/#.*$/,"")},t}),DeviceCenterWidget.define("mustache",[],function(){var e=function(){var e={},t=function(){};return t.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(e,t,n,r){r||(this.context=t,this.buffer=[]);if(!this.includes("",e)){if(r)return e;this.send(e);return}e=this.render_pragmas(e);var i=this.render_section(e,t,n);i===!1&&(i=this.render_tags(e,t,n,r));if(r)return i;this.sendLines(i)},send:function(e){e!==""&&this.buffer.push(e)},sendLines:function(e){if(e){var t=e.split("\n");for(var n=0;n<t.length;n++)this.send(t[n])}},render_pragmas:function(e){if(!this.includes("%",e))return e;var t=this,n=this.getCachedRegex("render_pragmas",function(e,t){return new RegExp(e+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+t,"g")});return e.replace(n,function(e,n,r){if(!t.pragmas_implemented[n])throw{message:"This implementation of mustache doesn't understand the '"+n+"' pragma"};t.pragmas[n]={};if(r){var i=r.split("=");t.pragmas[n][i[0]]=i[1]}return""})},render_partial:function(e,t,n){e=this.trim(e);if(!n||n[e]===undefined)throw{message:"unknown_partial '"+e+"'"};return typeof t[e]!="object"?this.render(n[e],t,n,!0):this.render(n[e],t[e],n,!0)},render_section:function(e,t,n){if(!this.includes("#",e)&&!this.includes("^",e))return!1;var r=this,i=this.getCachedRegex("render_section",function(e,t){return new RegExp("^([\\s\\S]*?)"+e+"(\\^|\\#)\\s*(.+)\\s*"+t+"\n*([\\s\\S]*?)"+e+"\\/\\s*\\3\\s*"+t+"\\s*([\\s\\S]*)$","g")});return e.replace(i,function(e,i,s,o,u,a){var f=i?r.render_tags(i,t,n,!0):"",l=a?r.render(a,t,n,!0):"",c,h=r.find(o,t);return s==="^"?!h||r.is_array(h)&&h.length===0?c=r.render(u,t,n,!0):c="":s==="#"&&(r.is_array(h)?c=r.map(h,function(e){return r.render(u,r.create_context(e),n,!0)}).join(""):r.is_object(h)?c=r.render(u,r.create_context(h),n,!0):typeof h=="function"?c=h.call(t,u,function(e){return r.render(e,t,n,!0)}):h?c=r.render(u,t,n,!0):c=""),f+c+l})},render_tags:function(e,t,n,r){var i=this,s=function(){return i.getCachedRegex("render_tags",function(e,t){return new RegExp(e+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+t+"+","g")})},o=s(),u=function(e,r,u){switch(r){case"!":return"";case"=":return i.set_delimiters(u),o=s(),"";case">":return i.render_partial(u,t,n);case"{":return i.find(u,t);default:return i.escape(i.find(u,t))}},a=e.split("\n");for(var f=0;f<a.length;f++)a[f]=a[f].replace(o,u,this),r||this.send(a[f]);if(r)return a.join("\n")},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]),this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){function n(e){return e===!1||e===0||e}e=this.trim(e);var r;return n(t[e])?r=t[e]:n(this.context[e])&&(r=this.context[e]),typeof r=="function"?r.apply(t):r!==undefined?r:""},includes:function(e,t){return t.indexOf(this.otag+e)!=-1},escape:function(e){return e=String(e===null?"":e),e.replace(/&(?!\w+;)|["'<>\\]/g,function(e){switch(e){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return e}})},create_context:function(e){if(this.is_object(e))return e;var t=".";this.pragmas["IMPLICIT-ITERATOR"]&&(t=this.pragmas["IMPLICIT-ITERATOR"].iterator);var n={};return n[t]=e,n},is_object:function(e){return e&&typeof e=="object"},is_array:function(e){return Object.prototype.toString.call(e)==="[object Array]"},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(e,t){if(typeof e.map=="function")return e.map(t);var n=[],r=e.length;for(var i=0;i<r;i++)n.push(t(e[i]));return n},getCachedRegex:function(t,n){var r=e[this.otag];r||(r=e[this.otag]={});var i=r[this.ctag];i||(i=r[this.ctag]={});var s=i[t];return s||(s=i[t]=n(this.otag,this.ctag)),s}},{name:"mustache.js",version:"0.4.0-dev",to_html:function(e,n,r,i){var s=new t;i&&(s.send=i),s.render(e,n||{},r);if(!i)return s.buffer.join("\n")}}}();return e}),DeviceCenterWidget.define("data/ga",[],function(){var e=function(){};return e.prototype.identifyUser=function(e){setTimeout(function(){try{_gaq.push(["_setCustomVar",1,"Usertype",parseInt(e)*618+"",1])}catch(t){}},25)},e.prototype.event=function(e){var t=e.split(":");t[3]!==void 0&&(t[3]=parseInt(t[3])),setTimeout(function(){try{_gaq.push(["_trackEvent"].concat(t))}catch(e){}},25)},new e}),DeviceCenterWidget.define("data/cookie",[],function(){function r(e,n){var r={};if(i(e)&&e.length>0){var s=n?t:u,o=e.split(/;\s/g),a,f,l;for(var c=0,h=o.length;c<h;c++){l=o[c].match(/([^=]+)=/i);if(l instanceof Array)try{a=t(l[1]),f=s(o[c].substring(l[1].length+1))}catch(p){}else a=t(o[c]),f="";a&&(r[a]=f)}}return r}function i(e){return typeof e=="string"}function s(e){return i(e)&&e!==""}function o(e){if(!s(e))throw new TypeError("Cookie name must be a non-empty string")}function u(e){return e}var e={};e.version="1.0.1";var t=decodeURIComponent,n=encodeURIComponent;return e.get=function(e,t){o(e),typeof t=="function"?t={converter:t}:t=t||{};var n=r(document.cookie,!t.raw);return(t.converter||u)(n[e])},e.set=function(e,t,r){o(e),r=r||{};var i=r.expires,u=r.domain,a=r.path;r.raw||(t=n(String(t)));var f=e+"="+t,l=i;return typeof l=="number"&&(l=new Date,l.setDate(l.getDate()+i)),l instanceof Date&&(f+="; expires="+l.toUTCString()),s(u)&&(f+="; domain="+u),s(a)&&(f+="; path="+a),r.secure&&(f+="; secure"),document.cookie=f,f},e.remove=function(e,t){return t=t||{},t.expires=new Date(0),this.set(e,"",t)},e}),DeviceCenterWidget.define("data/cookiescanner",["lib/event/eventproxy","config","data/cookie"],function(e,t,n){var r=function(){e.attachTo(this),this._username=null,this._scanner=null};return r.prototype.start=function(e){if(this._scanner)return;var r=this;(function(){r._scanner=setTimeout(arguments.callee,1e3);var i=n.get(t.user.CURRENT_DEVICE_COOKIE+"_"+e);i?r.publish("device",i):r.publish("empty")})()},r.prototype.stop=function(){this._scanner&&(clearTimeout(this._scanner),this._scanner=null)},r}),DeviceCenterWidget.define("data/onlinedevicesmanager",["lib/event/eventproxy","util"],function(e,t){var n=function(){e.attachTo(this),this._onlineDevicesList=[],this._onlineDevicesHash={},this._devicesHash={},this._cache=null,this._initialized=!1};return n.prototype.setOnlineDevicesList=function(e){var n=this._onlineDevicesList,r=this._onlineDevicesHash,i=this,s,o;this._cache=null,this._onlineDevicesList=e,this._onlineDevicesHash={},s=t.filter(this._onlineDevicesList,function(e){return i._onlineDevicesHash[e]=!0,!r[e]}),this._initialized||(this._initialized=!0,this.publish("init")),t.each(s,function(e,t){i.publish("online",t)}),t.each(n,function(e,t){i._onlineDevicesHash[t]||i.publish("offline",t)})},n.prototype.activateDevice=function(e){this.isDeviceOffline(e)&&(this._tagDeviceActive(e),this.publish("online",e))},n.prototype.deactivateDevice=function(e){this.isDeviceOnline(e)&&(this._tagDeviceInactive(e),this.publish("offline",e))},n.prototype.cacheNewDevices=function(e){e&&e.length&&(this._cache=e)},n.prototype.checkCache=function(e){if(!this._cache)return;var n=this._cache,r=this;this._cache=null,t.each(n,function(t,n){e(n)&&r.activateDevice(n)})},n.prototype.isDeviceOnline=function(e){return!!this._devicesHash[e]},n.prototype.isDeviceOffline=function(e){return!this.isDeviceOnline(e)},n.prototype.clear=function(){this._initialized=!1,this._onlineDevicesList=[],this._onlineDevicesHash={},this._cache=null,this._devicesHash={}},n.prototype._tagDeviceActive=function(e){this._devicesHash[e]=!0},n.prototype._tagDeviceInactive=function(e){delete this._devicesHash[e]},n}),DeviceCenterWidget.define("data/currentdevicemanager",["lib/event/eventproxy","config","data/cookie"],function(e,t,n){var r=function(){e.attachTo(this),this._cache=null,this._currentDeviceId=null,this._namespace=null};return r.prototype.bindNamespace=function(e){this._namespace=e},r.prototype.getCurrentDeviceId=function(){return this._currentDeviceId},r.prototype.setCurrentDeviceId=function(e){this._cache=null,e!==this._currentDeviceId&&(n.set(t.user.CURRENT_DEVICE_COOKIE+"_"+this._namespace,e,{expires:2592e3,path:"/",domain:"wandoujia.com"}),this._currentDeviceId=e,this.publish("change",e))},r.prototype.clearCurrentDeviceId=function(){this._currentDeviceId=null,n.remove(t.user.CURRENT_DEVICE_COOKIE+"_"+this._namespace,{path:"/",domain:"wandoujia.com"})},r.prototype.cacheDeviceId=function(e){this._cache=e},r.prototype.checkCache=function(){if(!this._cache)return;var e=this._cache;this._cache=null,this.setCurrentDeviceId(e)},r.prototype.clear=function(){this._currentDeviceId=null,this._cache=null,this._namespace=null},r}),DeviceCenterWidget.define("data/devicesinfo",["lib/event/eventproxy","lib/states/statesmachine","config","data/cookiescanner"],function(e,t,n,r){var i=function(){e.attachTo(this),this._statesMachine=new t(this),this._account={},this._devicesList=[],this._devicesHash={},this.length=0,this._initializeStatesMachine(),this._statesMachine.run("standby")};i.prototype.getUserId=function(){return this._account.uid},i.prototype.getUserName=function(){return this._account.username},i.prototype.getUserEmail=function(){return this._account.email},i.prototype.get=function(e){return this._devicesList[e||0]},i.prototype.getByDeviceId=function(e){return this._devicesHash[e]},i.prototype.getAll=function(){return this._devicesList},i.prototype.each=function(){return $.each.apply($,[this._devicesList].concat(slice.call(arguments)))},i.prototype.map=function(){return $.map.apply($,[this._devicesList].concat(slice.call(arguments)))},i.prototype.find=function(){return $.grep.apply($,[this._devicesList].concat(slice.call(arguments)))},i.prototype.exist=function(e){return!!e&&!!this._devicesHash[e]},i.prototype.fetch=function(){this._statesMachine.handleEvent("fetch")},i.prototype.abortFetch=function(){this._statesMachine.handleEvent("stop")},i.prototype._initializeStatesMachine=function(){var e=this._statesMachine,t=null,n=null,r=0,i=5;e.addActionTransition({state:"standby",event:"fetch",transition:function(){return n=s(this),"pending"}}),e.addActionTransition({state:"standby",event:"stop",transition:"@standby"}),e.addActionTransition({state:"pending",event:"fetch",transition:"@pending"}),e.addActionTransition({state:"pending",event:"arrive",transition:function(){return r=0,this.publish("update"),"standby"}}),e.addActionTransition({state:"pending",event:"lost",transition:function(){var n=Math.max(Math.max(r-i,0)*15e3-1e3)+1e3;return t=setTimeout(function(){e.handleEvent("timeout")},n),r+=1,"blocking"}}),e.addActionTransition({state:"pending",event:"stop",transition:function(){return n.abort(),this.publish("abort"),e.doActionTransition("standby","stop")}}),e.addActionTransition({state:"blocking",event:"fetch",transition:"@blocking"}),e.addActionTransition({state:"blocking",event:"timeout",transition:"=fetch@standby"}),e.addActionTransition({state:"blocking",event:"stop",transition:function(){return clearTimeout(t),e.doActionTransition("standby","stop")}})};var s=function(e){return $.ajax({dataType:"jsonp",url:n.service.ACCOUNT_URL,data:{"do":"profile",fields:"username,email,phonedata"},success:function(t){t===0?e.publish("signout"):(e._account=t,e._devicesHash={},e._devicesList=t.phonedata,$.each(t.phonedata,function(t,n){e._devicesHash[n.dev_id]=n}),e.length=t.phonedata.length,e._statesMachine.handleEvent("arrive"))},error:function(t,n){n!=="abort"&&e._statesMachine.handleEvent("lost")}})};return i}),DeviceCenterWidget.define("data/user",["lib/event/eventproxy","lib/states/statesmachine","config","data/cookiescanner","data/onlinedevicesmanager","data/currentdevicemanager","data/devicesinfo"],function(e,t,n,r,i,s,o){var u=function(){e.attachTo(this),this._statesMachine=new t(this),this._cookieScanner=new r,this._devicesInfo=new o,this._onlineDevicesManager=new i,this._currentDeviceManager=new s,this._bindEvents(),this._initializeStatesMachine(),this._statesMachine.run("init")};u.prototype.run=function(){this._statesMachine.handleEvent("start")},u.prototype.stop=function(){this._statesMachine.handleEvent("stop"),this._onlineDevicesManager.clear(),this._currentDeviceManager.clear()},u.prototype.getAccountInfo=function(){var e=this._devicesInfo;return{uid:e.getUserId(),username:e.getUserName(),email:e.getUserEmail()}},u.prototype.setOnlineDevicesList=function(e){this._statesMachine.handleEvent("sync");var t=[],n={},r=this._devicesInfo,i=this._onlineDevicesManager;$.each(e,function(e,i){r.exist(i)?n[i]=!0:t.push(i)}),$.each(r.getAll(),function(e,t){var r=t.dev_id;n[r]?i.activateDevice(r):i.deactivateDevice(r)}),t.length&&(this._onlineDevicesManager.cacheNewDevices(t),this._statesMachine.handleEvent("update"))},u.prototype.isDeviceOnline=function(e){return this._onlineDevicesManager.isDeviceOnline(e)},u.prototype.setCurrentDevice=function(e){if(e===null)return!1;var t=e.dev_id||e;this._devicesInfo.exist(t)?this._currentDeviceManager.setCurrentDeviceId(t):(this._currentDeviceManager.cacheDeviceId(t),this._statesMachine.handleEvent("update"))},u.prototype.getCurrentDevice=function(){var e=this._currentDeviceManager.getCurrentDeviceId();return e?this.getDevice(e):null},u.prototype.getDevice=function(e){var t;return e?(t=[this._devicesInfo.getByDeviceId(e)],this._generateDevicesInfo(t)[0]):(t=this._devicesInfo.getAll(),this._generateDevicesInfo(t))},u.prototype._bindEvents=function(){var e=this._cookieScanner,t=this._devicesInfo,n=this._statesMachine,r=this._onlineDevicesManager,i=this._currentDeviceManager,s=this;e.subscribe("empty",function(){var e;t.length&&(e=typeof t.get(0)!="undefined"?t.get(0).dev_id:null,s.setCurrentDevice(e))}).subscribe("device",function(e){t.exist(e)?s.setCurrentDevice(e):i.clearCurrentDeviceId()}),t.subscribe("update",function(){n.handleEvent("complete")}).subscribe("signout",function(){n.handleEvent("stop")}),r.subscribe("online",function(e){t.getByDeviceId(e).online=!0,s.publish("online",e)}).subscribe("offline",function(e){t.getByDeviceId(e).online=!1,s.publish("offline",e)}),i.subscribe("change",function(e){s.publish("change",s.getDevice(e))})},u.prototype._initializeStatesMachine=function(){var e=this._statesMachine;e.addActionTransition({state:"init",event:"start",transition:function(){return this._devicesInfo.fetch(),"initializing"}}),e.addActionTransition({state:"init",event:"stop",transition:"@init"}),e.addActionTransition({state:"initializing",event:"complete",transition:function(){return this._currentDeviceManager.bindNamespace(this.getAccountInfo().uid),this.publish("init",this.getDevice()),"syncing"}}),e.addActionTransition({state:"initializing",event:"stop",transition:function(){return this._devicesInfo.abortFetch(),"init"}}),e.addActionTransition({state:"syncing",event:"sync",transition:function(){return this._cookieScanner.start(this.getAccountInfo().uid),"ready"}}),e.addActionTransition({state:"syncing",event:"stop",transition:"@init"}),e.addActionTransition({state:"ready",event:"update",transition:function(){return this._devicesInfo.fetch(),"updating"}}),e.addActionTransition({state:"ready",event:"sync",transition:"@ready"}),e.addActionTransition({state:"ready",event:"stop",transition:function(){return this._cookieScanner.stop(),"init"}}),e.addActionTransition({state:"updating",event:"complete",transition:function(){var e=this;return this.publish("update",this.getDevice()),this._currentDeviceManager.checkCache(),this._onlineDevicesManager.checkCache(function(t){return e._devicesInfo.exist(t)}),"ready"}}),e.addActionTransition({state:"updating",event:"update",transition:"@updating"}),e.addActionTransition({state:"updating",event:"sync",transition:"@updating"}),e.addActionTransition({state:"updating",event:"stop",transition:function(){return this._devicesInfo.abortFetch(),e.doActionTransition("ready","stop")}})},u.prototype._generateDevicesInfo=function(e){var t=this._currentDeviceManager.getCurrentDeviceId(),n=this;return $.map(e,function(e){return e=a(e),e.online=n._onlineDevicesManager.isDeviceOnline(e.dev_id),e.current=e.dev_id===t,e})};var a=function(e){return $.extend(!0,{},{source:e}).source};return new u}),DeviceCenterWidget.define("tpl/nls/root/widget",{syncingTip:"正在获取手机信息…",registerTip:"未连接手机，点击",btnOpenGuide:"连接手机",onlineTip:"在线",offlineTip:"不在线",menuItemOpenGuide:"连接新手机",menuItemManage:"管理设备",menuItemApps:"推送过的应用",menuItemSignout:"退出登录",onlinePushNotice:"豌豆荚将开始安装 {0}",offlinePushNotice:"手机连接 Wi-Fi 时将安装 {0} 个应用:",mobileAppUpgradeNotice:"请升级豌豆荚 Android 版到最新以使用离线推送"}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||undefined),u=[];DeviceCenterWidget.define("text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),a={version:"0.27.1",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw new Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&i.inlineText&&(u[e]=n),r(n)},load:function(e,t,n,u){var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n,r){if(t in u){var i=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=a.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";a.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},a.write(e,o,n,i)},i)}},a})}(),DeviceCenterWidget.define("text!tpl/stylesheets/screen.css",[],function(){return'.status-sprite,.devicecenter.devicecenter-offline .sync-status .indicator,.devicecenter.devicecenter-online .sync-status .indicator{background-image:url(\'/style/images/www/account/status-sce5e5911d1.png\');background-repeat:no-repeat}.icon-sprite,.dcw-comp .device-status.ds-none .device-icon .alert,.dcw-comp .device-status.ds-offline .device-icon .alert,.dcw-overlay .dialog .close,.dcw-guide .dialog .content .bd .guide .help ol li .ico-disc,.dcw-guide .dialog .content .bd .guide .help ol li .ico-current,.dc-notifier .cue,.dcw-deviceslist .dl-device.dl-current .dl-checkmark,.devicecenter .device-menu .name .deviceslist-trigger,.devicecenter .device-menu .deviceslist .device .ico-selected,.devicecenter.devicecenter-pending .device-menu .alert,.devicecenter.devicecenter-none .device-menu .alert,.devicecenter.devicecenter-offline .device-menu .alert,.dcw-widget-container .dcw-device-thumb .push-indicator .icon,.dcw-widget-container .btn-open-menu .caret{background-image:url(\'http://img.wdjimg.com/style/images/www/account/icon-se286e2ec36.png\');background-repeat:no-repeat}.diagram-sprite,.dcw-guide .dialog .content .bd .cover .diagram,.dcw-guide .dialog .content .bd .guide .preview ol li.step1,.dcw-guide .dialog .content .bd .guide .preview ol li.step2,.dcw-guide .dialog .content .bd .guide .preview ol li.step3,.dcw-guide .dialog .content .bd .guide .preview ol li.step4{background-image:url(\'/style/images/www/account/diagram-sd5eb243787.png\');background-repeat:no-repeat}.dcw-comp{color:#333}.dcw-comp div,.dcw-comp span,.dcw-comp applet,.dcw-comp object,.dcw-comp iframe,.dcw-comp h1,.dcw-comp h2,.dcw-comp h3,.dcw-comp h4,.dcw-comp h5,.dcw-comp h6,.dcw-comp p,.dcw-comp blockquote,.dcw-comp pre,.dcw-comp a,.dcw-comp abbr,.dcw-comp acronym,.dcw-comp address,.dcw-comp big,.dcw-comp cite,.dcw-comp code,.dcw-comp del,.dcw-comp dfn,.dcw-comp em,.dcw-comp img,.dcw-comp ins,.dcw-comp kbd,.dcw-comp q,.dcw-comp s,.dcw-comp samp,.dcw-comp small,.dcw-comp strike,.dcw-comp strong,.dcw-comp sub,.dcw-comp sup,.dcw-comp tt,.dcw-comp var,.dcw-comp b,.dcw-comp u,.dcw-comp i,.dcw-comp center,.dcw-comp dl,.dcw-comp dt,.dcw-comp dd,.dcw-comp ol,.dcw-comp ul,.dcw-comp li,.dcw-comp fieldset,.dcw-comp form,.dcw-comp label,.dcw-comp legend,.dcw-comp table,.dcw-comp caption,.dcw-comp tbody,.dcw-comp tfoot,.dcw-comp thead,.dcw-comp tr,.dcw-comp th,.dcw-comp td,.dcw-comp article,.dcw-comp aside,.dcw-comp canvas,.dcw-comp details,.dcw-comp embed,.dcw-comp figure,.dcw-comp figcaption,.dcw-comp footer,.dcw-comp header,.dcw-comp hgroup,.dcw-comp menu,.dcw-comp nav,.dcw-comp output,.dcw-comp ruby,.dcw-comp section,.dcw-comp summary,.dcw-comp time,.dcw-comp mark,.dcw-comp audio,.dcw-comp video{margin:0;padding:0;border:0;font-size:100%;font:13px/18px "Helvetica Neue", "Lucida Grande", "Segoe UI", Tahoma, Arial, Verdana, "Microsoft Yahei", "STHeiti", sans-serif;vertical-align:baseline}.dcw-comp table{border-collapse:collapse;border-spacing:0}.dcw-comp caption,.dcw-comp th,.dcw-comp td{text-align:left;font-weight:normal;vertical-align:middle}.dcw-comp q,.dcw-comp blockquote{quotes:none}.dcw-comp q:before,.dcw-comp q:after,.dcw-comp blockquote:before,.dcw-comp blockquote:after{content:"";content:none}.dcw-comp a img{border:none}.dcw-comp a{text-decoration:none;color:#38d}.dcw-comp a:hover,.dcw-comp a:focus{text-decoration:underline}.dcw-comp ul,.dcw-comp ol,.dcw-comp dl{list-style-image:none;list-style-type:none;margin-left:0}.dcw-comp .device-status{*zoom:1;position:relative;background:#fff}.dcw-comp .device-status:after{content:"\\0020";display:block;height:0;clear:both;overflow:hidden;visibility:hidden}.dcw-comp .device-status .device-icon{position:relative;float:left;display:inline-block;*display:inline;zoom:1;height:60px;text-align:center}.dcw-comp .device-status .device-icon .img{zoom:1;-moz-transition-property:opacity;-o-transition-property:opacity;-webkit-transition-property:opacity;transition-property:opacity;-moz-transition-duration:1s;-o-transition-duration:1s;-webkit-transition-duration:1s;transition-duration:1s}.dcw-comp .device-status .device-icon .alert{display:none;position:absolute;left:-8px;bottom:0}.dcw-comp .device-status .model-name{float:left;height:60px;line-height:60px;text-indent:7px;font-weight:bold}.dcw-comp .device-status .active-status{float:left;height:60px;margin-left:10px;line-height:60px}.dcw-comp .device-status .active-status .on,.dcw-comp .device-status .active-status .off{font-weight:bold;line-height:60px}.dcw-comp .device-status .active-status .off{display:none;color:#888}.dcw-comp .device-status.ds-none .device-icon .img{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5}.dcw-comp .device-status.ds-none .device-icon .alert{display:block;background-position:0 -47px;width:16px;height:17px;font-size:0;line-height:0}.dcw-comp .device-status.ds-none .model-name{color:#888;font-weight:normal}.dcw-comp .device-status.ds-none .active-status{display:none}.dcw-comp .device-status.ds-offline .device-icon .img{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5}.dcw-comp .device-status.ds-offline .device-icon .alert{display:block;background-position:0 -64px;width:16px;height:17px;font-size:0;line-height:0}.dcw-comp .device-status.ds-offline .model-name{color:#888}.dcw-comp .device-status.ds-offline .active-status .on{display:none}.dcw-comp .device-status.ds-offline .active-status .off{display:inline}.dcw-overlay{position:absolute;left:0;top:0}.dcw-overlay .mask{background:#000;filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=70);opacity:0.7}.dcw-overlay .dialog{position:absolute;left:0;top:0;width:540px;height:360px;border:1px solid #e5e5e5;background:#fff}.dcw-overlay .dialog .close{background-position:0 -4px;width:13px;height:13px;font-size:0;line-height:0;position:absolute;left:515px;top:11px;text-indent:-119988px;overflow:hidden;text-align:left;cursor:pointer}.dcw-overlay .dialog .content{position:relative}.dcw-overlay .dialog .content .hd{height:30px}.dcw-overlay .dialog .content .bd{position:relative;height:283px;margin:0 12px}.dcw-overlay .dialog .content .ft{overflow:hidden;*zoom:1;position:relative;height:46px;margin:0 12px;border-top:1px solid #ccc}.dcw-overlay .dialog .content .ft .cancel{float:right;margin:9px 5px 0 0;height:28px;padding:0 15px;border:1px solid #ccc;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-color:#fff;*zoom:1;filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr=\'#FFFFFFFF\', endColorstr=\'#FFE4E6E6\');background-image:-moz-linear-gradient(top, #ffffff 0%,#e4e6e6 100%);background-image:-o-linear-gradient(top, #ffffff 0%,#e4e6e6 100%);background-image:-webkit-linear-gradient(top, #ffffff 0%,#e4e6e6 100%);background-image:linear-gradient(to bottom, #ffffff 0%,#e4e6e6 100%);cursor:pointer;color:#333;line-height:28px;text-align:center}.dcw-overlay .dialog .content .ft .button{float:right;margin:8px 0 0 0;height:30px;padding:0 26px;border:1px solid #fff;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;background-color:#81bd2d;*zoom:1;filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0, startColorstr=\'#FF81BD2D\', endColorstr=\'#FF69AC05\');background-image:-moz-linear-gradient(top, #81bd2d 0%,#69ac05 100%);background-image:-o-linear-gradient(top, #81bd2d 0%,#69ac05 100%);background-image:-webkit-linear-gradient(top, #81bd2d 0%,#69ac05 100%);background-image:linear-gradient(to bottom, #81bd2d 0%,#69ac05 100%);cursor:pointer;color:#fff;line-height:30px;text-align:center}.dcw-overlay .dialog .content .ft .button.button-disable{border-color:#ccc;background:#f2f2f2;filter:none;cursor:default;color:#999}.dcw-guide{z-index:20000}.dcw-guide .dialog .content .hd{display:none}.dcw-guide .dialog .content .bd{height:313px}.dcw-guide .dialog .content .bd .cover{position:relative;padding:124px 0 0 213px;zoom:1}.dcw-guide .dialog .content .bd .cover .diagram{background-position:0 0;width:106px;height:156px;position:absolute;font-size:0;line-height:0;left:42px;top:98px}.dcw-guide .dialog .content .bd .cover h2{font-size:17px}.dcw-guide .dialog .content .bd .cover p{line-height:23px;margin-top:23px}.dcw-guide .dialog .content .bd .guide{position:relative;padding:37px 0 0 279px;zoom:1}.dcw-guide .dialog .content .bd .guide .preview{width:257px;height:243px;position:absolute;left:1px;top:39px;overflow:hidden;zoom:1}.dcw-guide .dialog .content .bd .guide .preview ol{float:left;width:1028px;margin:0;-moz-transition-property:all;-o-transition-property:all;-webkit-transition-property:all;transition-property:all;-moz-transition-duration:0.3s;-o-transition-duration:0.3s;-webkit-transition-duration:0.3s;transition-duration:0.3s}.dcw-guide .dialog .content .bd .guide .preview ol.step-1{margin-left:0px}.dcw-guide .dialog .content .bd .guide .preview ol.step-2{margin-left:-257px}.dcw-guide .dialog .content .bd .guide .preview ol.step-3{margin-left:-514px}.dcw-guide .dialog .content .bd .guide .preview ol.step-4{margin-left:-771px}.dcw-guide .dialog .content .bd .guide .preview ol li{width:257px;height:243px;float:left}.dcw-guide .dialog .content .bd .guide .preview ol li.step1{background-position:0 -156px}.dcw-guide .dialog .content .bd .guide .preview ol li.step2{background-position:0 -399px}.dcw-guide .dialog .content .bd .guide .preview ol li.step3{background-position:0 -642px}.dcw-guide .dialog .content .bd .guide .preview ol li.step4{background-position:0 -870px}.dcw-guide .dialog .content .bd .guide .account{font-size:15px;color:#38d;font-weight:bold;margin-bottom:10px}.dcw-guide .dialog .content .bd .guide .devices{height:72px;overflow:auto;padding-right:22px;zoom:1;position:relative}.dcw-guide .dialog .content .bd .guide .devices .dcw-deviceslist{position:static}.dcw-guide .dialog .content .bd .guide .devices .dcw-deviceslist .dl-checkmark{display:none}.dcw-guide .dialog .content .bd .guide .help{margin:10px 0 0 0;padding:13px 0 0 11px;border-top:1px solid #ccc}.dcw-guide .dialog .content .bd .guide .help h3{margin-bottom:8px}.dcw-guide .dialog .content .bd .guide .help ol li{font-size:12px;color:#888;line-height:24px;position:relative;padding-left:18px;white-space:nowrap;cursor:pointer;zoom:1;-moz-transition-property:all;-o-transition-property:all;-webkit-transition-property:all;transition-property:all;-moz-transition-duration:0.3s;-o-transition-duration:0.3s;-webkit-transition-duration:0.3s;transition-duration:0.3s}.dcw-guide .dialog .content .bd .guide .help ol li .ico-disc{background-position:0 -29px;width:8px;height:8px;font-size:0;line-height:0;position:absolute;left:3px;top:8px}.dcw-guide .dialog .content .bd .guide .help ol li .ico-current{background-position:0 -17px;width:13px;height:12px;font-size:0;line-height:0;position:absolute;left:0;top:6px;display:none}.dcw-guide .dialog .content .bd .guide .help ol li.current{color:#333}.dcw-guide .dialog .content .bd .guide .help ol li.current .ico-disc{display:none}.dcw-guide .dialog .content .bd .guide .help ol li.current .ico-current{display:block}.dcw-guide .dialog .content .ft .later{float:left}.dcw-feedback{z-index:20000}.dcw-feedback .bd{overflow:hidden;*zoom:1;padding-left:10px}.dcw-feedback .bd .title{margin-top:56px;font-size:16px}.dcw-feedback .bd .checklist{margin:24px 0 5px}.dcw-feedback .bd .checklist li{line-height:24px}.dcw-feedback .bd .checklist li span{color:#38d;font-weight:bold}.dcw-feedback .bd .plot-appname{font-size:16px}.dcw-feedback .bd .plot-device-status{height:74px;margin-left:10px;margin-bottom:30px;position:relative}.dcw-feedback .bd .plot-device-status .device-status{padding:7px 0 7px 26px;height:60px}.dcw-feedback .bd .plot-device-status .dcw-deviceslist{position:absolute;left:0;top:0;height:74px;overflow:auto}.dcw-feedback .ft .guide-link{cursor:pointer;height:40px;margin-left:9px;line-height:40px;color:#38d}.dcw-feedback .ft .button{width:4em}.dc-notifier{position:fixed;_position:absolute;width:286px;padding:1px;border:1px solid #313131;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;z-index:19999;background:#829796}.dc-notifier .content{padding:1px 8px;-moz-border-radius:1px;-webkit-border-radius:1px;border-radius:1px;background:#313131;color:#fff}.dc-notifier .cue{background-position:0 -81px;width:18px;height:9px;font-size:0;line-height:0;position:absolute;left:16px;top:-8px}.dc-notifier .notice,.dc-notifier .tip,.dc-notifier .offline-push-tip{margin:8px 0}.dc-notifier .tip{color:#fff}.dc-notifier .offline-push-tip .abort{cursor:pointer}.dc-notifier .offline-push-tip .upgrade-notice{color:#fd3}.dcw-deviceslist{position:absolute}.dcw-deviceslist .dl-device{position:relative;height:24px;padding-right:50px;width:auto;_width:1px;line-height:24px;color:#666;white-space:nowrap;cursor:pointer}.dcw-deviceslist .dl-device.dl-current{cursor:default}.dcw-deviceslist .dl-checkmark{display:inline-block;*display:inline;zoom:1;width:12px;height:10px;margin:0 8px 0 10px;font-size:0;line-height:0}.dcw-deviceslist .dl-modelname{display:inline-block;*display:inline;zoom:1;height:24px;line-height:24px}.dcw-deviceslist .dl-status{position:absolute;top:0;*top:3px;right:0;width:40px;height:24px;line-height:24px}.dcw-deviceslist .dl-on,.dcw-deviceslist .dl-off{display:inline-block;*display:inline;zoom:1;height:24px;line-height:24px;font-size:11px;color:#666}.dcw-deviceslist .dl-on{display:none;color:#6a0}.dcw-deviceslist .dl-device.dl-active .dl-status .dl-on{display:inline}.dcw-deviceslist .dl-device.dl-active .dl-status .dl-off{display:none}.dcw-deviceslist .dl-device.dl-current .dl-checkmark{background-position:0 -90px}.devicecenter{position:relative;*zoom:1;font-size:12px;line-height:1.5;z-index:19999}.devicecenter:after{content:"\\0020";display:block;height:0;clear:both;overflow:hidden;visibility:hidden}.devicecenter a{text-decoration:none;color:#38d}.devicecenter a:hover{text-decoration:underline;color:#38d}.devicecenter .img{display:table-cell;vertical-align:middle;*display:block;overflow:hidden;text-align:center;white-space:nowrap;word-break:keep-all}.devicecenter .img .vam{display:none;*display:inline;*zoom:1;width:0;height:100%;vertical-align:middle}.devicecenter .img img{vertical-align:middle}.devicecenter .device-menu{color:#789;float:left;width:280px}.devicecenter .device-menu .icon{float:left;width:60px;height:70px;overflow:hidden;-moz-transition-property:opacity;-o-transition-property:opacity;-webkit-transition-property:opacity;transition-property:opacity;-moz-transition-duration:1s;-o-transition-duration:1s;-webkit-transition-duration:1s;transition-duration:1s}.devicecenter .device-menu .icon .img{width:60px;height:70px}.devicecenter .device-menu .alert{display:none;float:left;margin:48px 0 0 -50px;opacity:0.99}.devicecenter .device-menu .account,.devicecenter .device-menu .name,.devicecenter .device-menu .actions{float:left;width:220px}.devicecenter .device-menu .account{margin-top:8px;white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis;-moz-transition-property:margin;-o-transition-property:margin;-webkit-transition-property:margin;transition-property:margin;-moz-transition-duration:1s;-o-transition-duration:1s;-webkit-transition-duration:1s;transition-duration:1s}.devicecenter .device-menu .name{white-space:nowrap;overflow:hidden;-ms-text-overflow:ellipsis;-o-text-overflow:ellipsis;text-overflow:ellipsis;color:#333;font-weight:bold;font-size:14px}.devicecenter .device-menu .name .deviceslist-trigger{display:inline-block;*display:inline;zoom:1;background-position:0 0;width:6px;height:4px;font-size:0;line-height:0;margin-left:5px;position:relative;top:-3px}.devicecenter .device-menu .pending,.devicecenter .device-menu .none,.devicecenter .device-menu .online,.devicecenter .device-menu .offline{display:none}.devicecenter .device-menu .deviceslist{position:absolute;border:1px solid #cbcbcb;-moz-box-shadow:0 1px 1px rgba(0,0,0,0.4);-webkit-box-shadow:0 1px 1px rgba(0,0,0,0.4);box-shadow:0 1px 1px rgba(0,0,0,0.4);display:none;background:#fff}.devicecenter .device-menu .deviceslist .device{cursor:default;position:relative;padding:0 50px 0 30px;height:24px;line-height:24px;color:#666;_width:1px;white-space:nowrap;cursor:pointer}.devicecenter .device-menu .deviceslist .device .ico-selected{background-position:0 -90px;width:12px;height:10px;font-size:0;line-height:0;position:absolute;left:10px;top:7px;visibility:hidden}.devicecenter .device-menu .deviceslist .device .status-online,.devicecenter .device-menu .deviceslist .device .status-offline{width:40px;height:24px;position:absolute;right:0;top:0;font-size:11px}.devicecenter .device-menu .deviceslist .device .status-online{color:#6a0;display:none}.devicecenter .device-menu .deviceslist .device .status-offline{color:#666}.devicecenter .device-menu .deviceslist .device.current .ico-selected{visibility:visible}.devicecenter .device-menu .deviceslist .device.device-online .status-online{display:block}.devicecenter .device-menu .deviceslist .device.device-online .status-offline{display:none}.devicecenter .sync-status{float:left;width:80px}.devicecenter .sync-status .indicator{width:51px;height:51px;line-height:51px;margin:11px 0 0 17px;text-align:center}.devicecenter .sync-status .indicator .online,.devicecenter .sync-status .indicator .offline{display:none}.devicecenter.devicecenter-signin .device-menu{float:none;width:100%}.devicecenter.devicecenter-signin .device-menu .icon{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5}.devicecenter.devicecenter-signin .device-menu .name{width:auto;font-weight:normal;margin-top:17px}.devicecenter.devicecenter-signin .device-menu .actions{width:300px;height:24px;line-height:24px;vertical-align:middle}.devicecenter.devicecenter-signin .device-menu .actions .do-download{display:inline-block;*display:inline;zoom:1;vertical-align:middle;text-indent:0}.devicecenter.devicecenter-pending .device-menu,.devicecenter.devicecenter-none .device-menu{width:100%}.devicecenter.devicecenter-pending .device-menu .icon,.devicecenter.devicecenter-none .device-menu .icon{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5}.devicecenter.devicecenter-pending .device-menu .alert,.devicecenter.devicecenter-none .device-menu .alert{display:block;background-position:0 -47px;width:16px;height:17px;font-size:0;line-height:0}.devicecenter.devicecenter-pending .device-menu .account,.devicecenter.devicecenter-none .device-menu .account{margin-top:8px}.devicecenter.devicecenter-pending .device-menu .actions,.devicecenter.devicecenter-none .device-menu .actions{width:300px}.devicecenter.devicecenter-pending .sync-status,.devicecenter.devicecenter-none .sync-status{display:none}.devicecenter.devicecenter-pending .device-menu .pending{display:inline}.devicecenter.devicecenter-none .device-menu .none{display:inline}.devicecenter.devicecenter-offline .device-menu .icon{filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=50);opacity:0.5}.devicecenter.devicecenter-offline .device-menu .alert{display:block;background-position:0 -64px;width:16px;height:17px;font-size:0;line-height:0}.devicecenter.devicecenter-offline .device-menu .account{margin-top:8px}.devicecenter.devicecenter-offline .device-menu .offline{display:inline}.devicecenter.devicecenter-offline .device-menu .offline strong{color:#e44}.devicecenter.devicecenter-offline .sync-status .indicator{background-position:0 0;color:#789}.devicecenter.devicecenter-offline .sync-status .indicator .offline{display:inline}.devicecenter.devicecenter-online .device-menu .account{margin-top:8px}.devicecenter.devicecenter-online .device-menu .online{display:inline}.devicecenter.devicecenter-online .sync-status .indicator{background-position:0 -51px;color:#609177}.devicecenter.devicecenter-online .sync-status .indicator .online{display:inline}.dcw-widget-container{height:70px;position:relative}.dcw-widget-container .dcw-device-thumb{float:left;position:relative;padding:5px 10px 0 15px;cursor:pointer}.dcw-widget-container .dcw-device-thumb .push-indicator{position:absolute;left:1px;top:10px;width:28px;height:14px;font-size:0;line-height:0;-moz-border-radius:7px;-webkit-border-radius:7px;border-radius:7px;background:#e32c1b;-moz-box-shadow:0 1px 1px rgba(0,0,0,0.5);-webkit-box-shadow:0 1px 1px rgba(0,0,0,0.5);box-shadow:0 1px 1px rgba(0,0,0,0.5)}.dcw-widget-container .dcw-device-thumb .push-indicator .icon{background-position:0 -37px;width:9px;height:10px;font-size:0;line-height:0;position:absolute;left:9px;top:2px}.dcw-widget-container .dcw-device-thumb .device-status{float:left;background:transparent}.dcw-widget-container .dcw-device-thumb .device-status .device-icon .alert{bottom:35px}.dcw-widget-container .dcw-device-thumb .device-status .model-name,.dcw-widget-container .dcw-device-thumb .device-status .active-status{display:none}.dcw-widget-container .dcw-device-thumb .device-status.ds-offline .device-icon .alert{background-image:none}.dcw-widget-container .account-info{float:left}.dcw-widget-container .account-info div,.dcw-widget-container .account-info span{cursor:pointer}.dcw-widget-container .account-info .username{font-weight:bold;color:#666;font-size:12px}.dcw-widget-container .account-info .syncing-tip{font-size:12px}.dcw-widget-container .account-info .register-tip{*float:left;font-size:12px}.dcw-widget-container .account-info .register-tip a{font-size:12px}.dcw-widget-container .account-info .device-info .device-name{font-weight:bold;font-size:14px;vertical-align:middle}.dcw-widget-container .account-info .device-info .device-states{color:#999;font-size:12px;vertical-align:middle;background:transparent}.dcw-widget-container .account-info .device-info .device-online{color:#6a0}.dcw-widget-container .btn-open-menu{display:inline-block;*display:inline;zoom:1;*float:left;vertical-align:middle;width:20px;height:20px;font-size:0;line-height:0;cursor:pointer}.dcw-widget-container .btn-open-menu .caret{background-position:0 0;width:6px;height:4px;font-size:0;line-height:0;margin:7px 8px;cursor:pointer}.dcw-menu{min-width:180px;*width:180px;position:absolute;z-index:20000;border:1px solid #cccccc;-moz-box-shadow:rgba(0,0,0,0.25) 0 2px 1px;-webkit-box-shadow:rgba(0,0,0,0.25) 0 2px 1px;box-shadow:rgba(0,0,0,0.25) 0 2px 1px;padding:10px 0;background:#fff;overflow:hidden;*zoom:1}.dcw-menu .dcw-deviceslist{width:auto;_width:1px;position:relative}.dcw-menu .dcw-deviceslist .dl-device{padding:1.5px 60px 1.5px 10px}.dcw-menu .dcw-deviceslist .dl-device .dl-status{right:10px}.dcw-menu .dcw-deviceslist .dl-device:hover{background:#f0f0f0;*background:transparent}.dcw-menu .menu-item{height:27px;line-height:27px;padding:0 10px 0 45px;cursor:pointer;_float:left;_clear:both;*padding-left:40px}.dcw-menu .menu-item span,.dcw-menu .menu-item a{line-height:27px}.dcw-menu .menu-item:hover{background:#f0f0f0;*background:transparent}.dcw-menu .menu-item span{cursor:pointer}.dcw-menu .menu-item .account-name{color:#999;display:inline-block}.dcw-menu .menu-item .account-name i{display:inline-block;max-width:152px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.dcw-menu .menu-item:last-child{overflow:hidden}.dcw-menu .menu-item .edit-profile{color:#333;text-decoration:none;display:block}.dcw-menu .menu-item .edit-profile:hover{text-decoration:none}.dcw-menu .separator{_display:none;font-size:0;line-height:0;height:0;border-top:1px solid #eee;margin:5px}\n'}),DeviceCenterWidget.define("text!tpl/signin.mustache",[],function(){return'<div class="devicecenter devicecenter-signin">\n    <div class="device-menu">\n        <p class="icon"><span class="img"><span class="vam"></span><img alt="豌豆荚" src="http://static.wandoujia.com/files/devices_2/wdj/wdj-default-small.png"/></span></p>\n        <p class="actions">\n            <a href="{{signinURL}}" class="button-grey button-small login-button" data-ga="dev_widget:login">登录</a>\n        </p>\n    </div>\n\n</div>'}),DeviceCenterWidget.define("text!tpl/widget/frame.mustache",[],function(){return'<div class="dcw-comp dcw-widget-container">\n    <div class="dcw-comp dcw-device-thumb"><span class="push-indicator" style="display:none;"><span class="icon"></span></span></div>\n    <div class="account-info"></div>\n</div>'}),DeviceCenterWidget.define("text!tpl/widget/account.mustache",[],function(){return'<div class="username">{{username}}</div>\n{{#pending}}\n<div class="syncing-tip">{{#locale}}{{syncingTip}}{{/locale}}</div>\n{{/pending}}\n\n{{^pending}}\n    {{^device}}\n<div class="register-tip"><a class="btn-open-guide" href="###">{{#locale}}{{btnOpenGuide}}{{/locale}}</a><div class="btn-open-menu"><div class="caret"></div></div></div>\n    {{/device}}\n\n    {{#device}}\n<div class="device-info" data-did="{{dev_id}}">\n    {{#online}}<span class="device-states device-online"></span>{{/online}}\n    {{^online}}<span class="device-states"></span>{{/online}}\n    <div class="btn-open-menu"><div class="caret"></div></div>\n</div>\n    {{/device}}\n{{/pending}}'}),DeviceCenterWidget.define("text!tpl/devicestatus.mustache",[],function(){return'<span class="device-icon"><img class="img" alt="" src="{{img}}"/><span class="alert"></span></span>\n<span class="model-name">{{model}}</span>\n<span class="active-status"><span class="on">在线</span><span class="off">不在线</span></span>'}),DeviceCenterWidget.define("view/device",["lib/event/eventproxy","mustache","data/user","text!tpl/devicestatus.mustache"],function(e,t,n,r){var i='<div class="device-status"></div>',s=function(){e.attachTo(this),this.el=null,this._device=null};s.prototype.render=function(e){this.el||(this.el=$(i),o.apply(this)),this.el.appendTo(e),this.publish("render"),this.update(n.getDevice()[0])},s.prototype.update=function(e){var n,i;e?(n={model:e.model,img:e.phoneinfo.smallicon},e.online?i="online":i="offline"):(n={model:"手机未连接",img:"http://static.wandoujia.com/files/devices_2/wdj/wdj-default-small.png"},i="none"),this._device=e,this.el.html(t.to_html(r,n)),this._switchTo(i),this.publish("update")},s.prototype.blink=function(){this.el.animate({"background-color":"#fdf6da"},1e3).animate({"background-color":"#ffffff"},1e3)},s.prototype._switchTo=function(e){this.el.removeClass("ds-none ds-offline ds-online"),this.el.addClass("ds-"+e)};var o=function(){var e=this;n.subscribe("change",function(t){e.update(t)}).subscribe("online",function(t){e._device&&e._device.dev_id===t&&e._switchTo("online")}).subscribe("offline",function(t){e._device&&e._device.dev_id===t&&e._switchTo("offline")})};return s}),DeviceCenterWidget.define("text!tpl/widget/manual.mustache",[],function(){return'<div class="dcw-comp dcw-menu">\n    <div class="devices-selector"></div>\n    <div class="menu-item" data-action="openguide"><span class="btn-open-guide">{{#locale}}{{menuItemOpenGuide}}{{/locale}}</span></div>\n\n    <div class="menu-item" data-action="manage">{{#locale}}{{menuItemManage}}{{/locale}}</div>\n    <div class="separator"></div>\n    <div class="menu-item" data-action="apps">{{#locale}}{{menuItemApps}}{{/locale}}</div>\n    <div class="menu-item menu-photos" data-action="photos">云相册</div>\n    <div class="menu-item menu-backup" data-action="backup">云备份</div>\n    <div class="separator"></div>\n    {{#notSocialUsers}}\n    <div class="menu-item menu-profiles" data-action="profiles">修改密码</div>\n    {{/notSocialUsers}}\n    <div class="menu-item" data-action="signout"><span class="btn-signout">{{#locale}}{{menuItemSignout}}{{/locale}}</span></div>\n</div>'}),DeviceCenterWidget.define("text!tpl/deviceslist.mustache",[],function(){return'{{#devices}}\n<li class="dl-device {{#current}} dl-current {{/current}} {{#online}} dl-active {{/online}}" data-did="{{dev_id}}">\n    <span class="dl-checkmark"></span>\n    <span class="dl-modelname">{{model}}</span>\n    <span class="dl-status"><span class="dl-on">在线</span><span class="dl-off">不在线</span></span>\n</li>\n{{/devices}}\n'}),DeviceCenterWidget.define("view/deviceslist",["lib/event/eventproxy","lib/states/statesmachine","util","mustache","data/user","text!tpl/deviceslist.mustache"],function(e,t,n,r,i,s){var o='<ul class="dcw-comp dcw-deviceslist"></ul>',u={allowInteraction:!0},a=function(t){e.attachTo(this),this.el=null,this.options=n.extend({},u,t)};a.prototype.render=function(e){this.el||(this.el=$(o),f(this)),this.el.appendTo(e),this.publish("render");var t=i.getDevice();t.length&&this.update(t)},a.prototype.update=function(e){this.el.html(r.to_html(s,{devices:e})),this.publish("update")},a.prototype.blink=function(){try{this.el.animate({backgroundColor:"#fdf6da"},1e3).animate({backgroundColor:"#ffffff"},1e3)}catch(e){}},a.prototype.setCurrentDevice=function(e){var t=this.el.find(".dl-device.dl-current");t.data("did")!==e&&(t.removeClass("dl-current"),this.el.find('.dl-device[data-did="'+e+'"]').addClass("dl-current"),this.publish("currentDeviceChange",e))},a.prototype.toggleDeviceOnline=function(e,t){this.el.find('.dl-device[data-did="'+e+'"]').toggleClass("dl-active",t),t?this.publish("deviceOnline",e):this.publish("deviceOffline",e)};var f=function(e){var t=e.el,n=!!e.options.allowInteraction;n&&t.delegate(".dl-device:not(.dl-current)","click",function(e){var t=$(this).data("did");i.setCurrentDevice(t)}),i.subscribe("init",function(t){e.update(t)}).subscribe("update",function(t){e.update(t)}).subscribe("change",function(t){e.setCurrentDevice(t.dev_id)}).subscribe("online",function(t){e.toggleDeviceOnline(t,!0)}).subscribe("offline",function(t){e.toggleDeviceOnline(t,!1)})};return a}),DeviceCenterWidget.define("view/v2/devices_manual",["lib/event/eventproxy","lib/states/statesmachine","config","mustache","tpl/nls/root/widget","text!tpl/widget/manual.mustache","data/user","data/cookie","view/deviceslist"],function(e,t,n,r,i,s,o,u,a){var f=function(t){e.attachTo(this),this.container=$(t||document.body),this.devicesSelector=new a};f.prototype.render=function(){return this.el?!1:(this.el=$(r.to_html(s,{email:SnapPea.Account.getUserInfo()===undefined?undefined:SnapPea.Account.getUserInfo().email,notSocialUsers:SnapPea!==undefined&&SnapPea.Account.getUserInfo()!==undefined&&SnapPea.Account.getUserInfo().registerSource!=="qq,sina,renren"&&SnapPea.Account.getUserInfo().complete!==!1,locale:i})),c.apply(this),l.apply(this),this.devicesSelector.render(this.el.find(".devices-selector")),this.el.hide().appendTo(this.container),!0)},f.prototype.open=function(e){this.el.show(),this.el.offset({left:e.offset().left,top:e.offset().top+e.outerHeight()}),$(document).click(this,h)},f.prototype.close=function(){this.el.hide(),$(document).unbind("click",h)};var l=function(){var e=this;this.el.delegate(".menu-item","click",function(t){switch($(this).data("action")){case"openguide":e.publish("guide");break;case"signout":SnapPea.AccountHook.open({name:"logout",popup:!($.browser.msie&&$.browser.version.split(".")[0]<7),callback:function(){SnapPea.Account.checkUserLoginAsync({jsonp:!!($.browser.msie&&$.browser.version.split(".")[0]<7)}).fail(function(){DeviceCenter._signScanner.publish("welcome"),typeof window.updateUserStatus=="function"&&window.updateUserStatus(),DeviceCenter._user._devicesInfo._devicesList=[],o._statesMachine._currentState="init",o._onlineDevicesManager.clear(),o._currentDeviceManager.clear(),u.remove(n.user.CURRENT_DEVICE_COOKIE+"_"+(typeof SnapPea!="undefined"?SnapPea.Account.getUserInfo().uid:""),{path:"/",domain:".wandoujia.com"})})}});break;case"manage":window.location=n.page.MANAGEMENT;break;case"apps":window.location=n.page.PUSHED_APPS;break;case"photos":window.location="http://www.wandoujia.com/photos";break;case"backup":window.location="http://www.wandoujia.com/cloud/#/contacts";break;case"profiles":SnapPea.AccountHook.open({name:"password",callback:function(){}});break;default:}})},c=function(){var e=this;o.subscribe("init",function(t){e.el.find(".account-name").text("("+SnapPea.Account.getUserInfo().nick+")")}),o.subscribe("update",function(t){e.el.find(".account-name").text("("+SnapPea.Account.getUserInfo().nick+")")})},h=function(e){var t=e.data;$(e.target).closest(".dcw-device-thumb, .account-info, .btn-open-menu").length||t.close()};return f}),DeviceCenterWidget.define("view/v2/widget",["lib/event/eventproxy","mustache","config","data/ga","data/user","tpl/nls/root/widget","text!tpl/stylesheets/screen.css","text!tpl/signin.mustache","text!tpl/widget/frame.mustache","text!tpl/widget/account.mustache","view/device","view/v2/devices_manual"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=function(t){e.attachTo(this),this.container=$(t||".devicecenter"),this.deviceThumb=new l,this.devicesManual=new c};h.prototype.render=function(e){this.el?this.el.remove():($(document.body).append('<style type="text/css">'+o+"</style>"),d.apply(this));if(e==="frame"){this.devicesManual.render(),this.el=$(t.to_html(a)),this.el.find(".account-info").html(t.to_html(f,{username:"Hello!",pending:!0,locale:s}));var r=this.el.find(".dcw-device-thumb");this.deviceThumb.render(r),this.deviceThumb.el.prependTo(r)}else{if(e!=="signin")return!1;this.el=$(t.to_html(u,{signinURL:n.base.SIGNIN_URL,signupURL:n.base.SIGNUP_URL}))}return p.apply(this),this.container.append(this.el),!0},h.prototype.togglePushIndicator=function(e){this.el.find(".dcw-device-thumb .push-indicator").toggle(!!e)};var p=function(){var e=this,t=null;this.el.delegate(".dcw-device-thumb, .account-info, .btn-open-menu","click",function(t){e.devicesManual.open(e.el.find(".account-info"))}).delegate(".btn-open-guide","click",function(t){e.publish("guide"),t.preventDefault()}).delegate(".dcw-device-thumb","mouseenter",function(){t=setTimeout(function(){e.publish("pushlist")},300)}).delegate(".dcw-device-thumb","mouseleave",function(){clearTimeout(t)})},d=function(){var e=this;i.subscribe("init",function(n){var r;n.length?r=!0:r=!1,e.el.find(".account-info").html(t.to_html(f,{username:SnapPea.Account.getUserInfo().nick,pending:r,locale:s}))}),i.subscribe("change",function(t){v.apply(e.el.find(".account-info"),[t])}),i.subscribe("online",function(t){e.el.find(".account-info .device-info").data("did")===t&&v.apply(e.el.find(".account-info"),[i.getDevice(t)])}),i.subscribe("offline",function(t){e.el.find(".account-info .device-info").data("did")===t&&v.apply(e.el.find(".account-info"),[i.getDevice(t)])}),this.devicesManual.subscribe("guide",function(){e.publish("guide")})},v=function(e){this.html(t.to_html(f,{username:SnapPea.Account.getUserInfo().nick,device:e,locale:s}))};return h}),DeviceCenterWidget.define("text!tpl/notifier.mustache",[],function(){return'<div class="dc-notifier">\n    <div class="content">\n    </div>\n    <span class="cue"></span>\n</div>'}),DeviceCenterWidget.define("text!tpl/tip.mustache",[],function(){return'<div class="tip">{{message}}</div>'}),DeviceCenterWidget.define("text!tpl/offlinepushtip.mustache",[],function(){return'<div class="offline-push-tip">\n    <div class="amount">{{message}}</div>\n    <div class="apps">{{apps}}</div>\n    {{^support?}}\n    <div class="upgrade-notice">{{#locale}}{{mobileAppUpgradeNotice}}{{/locale}}</div>\n    {{/support?}}\n    <!-- <div class="actions"><span class="abort">取消推送</span></div> -->\n</div>'}),DeviceCenterWidget.define("view/notifier",["mustache","config","util","data/user","tpl/nls/root/widget","text!tpl/notifier.mustache","text!tpl/tip.mustache","text!tpl/offlinepushtip.mustache"],function(e,t,n,r,i,s,o,u){function l(e,t){var n,r,i,s,o,u;return n=e.offset(),u=$(window).scrollTop(),s=n.left+5,o=n.top+60>=u?n.top+60:u+9,{left:s,top:o}}var a,f;return a=f=function(){this.container=null,this.tipShell=null,this.tip=null,this.explorerShell=null,this.explorer=null,this._tipClosingTimer=null,this._offlinePushTip=null},$.extend(f.prototype,{render:function(n){var i,o,u;i=e.to_html(s,{}),this.tipShell=$(i),this.tip=this.tipShell.find(".content"),this.explorerShell=$(i),this.explorer=this.explorerShell.find(".content"),u=n.container||document.body,o=n.reference||document.body,this.container=$(u),this.reference=$(o),this.tipShell.hide(),this.explorerShell.hide(),this.container.append(this.tipShell),this.container.append(this.explorerShell);var a=this;this.tip.delegate(".offline-push-tip .abort","click",function(e){e.preventDefault(),$.post(t.service.OFFLINE_CLEAR_URL,{did:r.getCurrentDevice().dev_id}).then(function(){a.closePopup().always(function(){a.clearOfflinePushTip()})})})},publishTip:function(n){var r,i,s;r=n.message||"Oh no! You forgot pass me message Again!",i=e.to_html(o,{message:r}),i=$(i),this.tip.append(i),this.pop(),s=this.tipShell;var u=this;setTimeout(function(){u.closePopup().fail(function(){i.fadeOut("fast")})},t.notifier.TIP_SHOWN_DURATION)},publishOfflinePushTip:function(r){var s,o;this.clearOfflinePushTip(),s=e.to_html(u,{message:n.format(i.offlinePushNotice,r.num),apps:r.apps,"support?":r["support?"],locale:i}),s=$(s),this._offlinePushTip=s,this.tip.append(s),this.pop(),o=this.tipShell;var a=this;setTimeout(function(){a.closePopup().fail(function(){s.fadeOut("fast")})},t.notifier.TIP_SHOWN_DURATION)},clearOfflinePushTip:function(){this._offlinePushTip&&(this._offlinePushTip.stop(!0,!0),this._offlinePushTip.remove(),this._offlinePushTip=null)},show:function(){this.explorerShell.show(),this.explorerShell.offset(l(this.reference,this.explorerShell))},hide:function(){this.explorerShell.hide()},pop:function(){var e=this.tipShell,n;this._tipClosingTimer&&(clearTimeout(this._tipClosingTimer),this._tipClosingTimer=null),e.stop(!0,!0).fadeIn(t.notifier.TIP_FADE_DURATION),n=l(this.reference,e),e.css("position")==="fixed"?e.css({left:n.left,top:n.top-$(window).scrollTop()}):e.css({left:n.left,top:n.top})},closePopup:function(){var e=$.Deferred(),n=this;switch(this.tip.children(":visible").length){case 0:this.tipShell.hide(),e.resolve();break;case 1:this.tipShell.fadeOut(t.notifier.TIP_FADE_DURATION,function(){n.clearOfflinePushTip(),n.tip.empty(),e.resolve()});break;default:e.reject()}return e.promise()}}),a}),DeviceCenterWidget.define("text!tpl/widget/guide.mustache",[],function(){return'<div class="dcw-comp dcw-overlay dcw-guide">\n    <div class="mask"></div>\n    <div class="dialog">\n        <div class="content">\n            <div class="hd"></div>\n            <div class="bd">\n                <div class="cover" style="display:none;">\n                    <div class="diagram"></div>\n                    <h2>您还没有连接 Android 设备</h2>\n                    <p>连接您的设备后，您可以使用应用推送功能，<br>在 wandoujia.com 上选择应用直接安装到手机。</p>\n                </div>\n                <div class="guide" style="display:none;">\n                    <div class="preview">\n                        <ol>\n                            <li class="step1"></li>\n                            <li class="step2"></li>\n                            <li class="step3"></li>\n                            <li class="step4"></li>\n                        </ol>\n                    </div>\n                    <div class="account"></div>\n                    <div class="devices"></div>\n                    <div class="help">\n                        <h3>没有找到您的设备？请您</h3>\n                        <ol>\n                            <li class="current"><span class="ico-current"></span><span class="ico-disc"></span>手机打开wandoujia.com下载豌豆荚</li>\n                            <li><span class="ico-current"></span><span class="ico-disc"></span>安装豌豆荚 Android 版</li>\n                            <li><span class="ico-current"></span><span class="ico-disc"></span>打开豌豆荚, 登录账号</li>\n                            <li><span class="ico-current"></span><span class="ico-disc"></span>选择使用应用推送</li>\n                        </ol>\n                    </div>\n                </div>\n            </div>\n            <div class="ft">\n                <span class="cancel later" style="display:none;">暂不连接</span>\n                <span class="button continue" style="display:none;">连接我的设备</span>\n                <span class="button button-disable waiting" style="display:none;">等待手机登录…</span>\n                <span class="button finish" style="display:none;">完成</span>\n            </div>\n        </div>\n        <div class="close"></div>\n    </div>\n</div>'}),DeviceCenterWidget.define("view/v2/guide",["mustache","config","lib/states/statesmachine","lib/event/eventproxy","data/user","view/deviceslist","data/ga","data/cookie","text!tpl/widget/guide.mustache","text!tpl/devicestatus.mustache"],function(e,t,n,r,i,s,o,u,a,f){var l=function(){r.attachTo(this),this._container=null,this._overlay=null,this.el=null,this._states=v.apply(this),this._devicesList=new s,this._slider=b(),this._stayTimestamp=null,this._cacheDevicesAmount=null,this._repositionInterval=null};l.prototype.render=function(t){return this._container=t||document.body,this._overlay=$(e.to_html(a)).hide(),this.el=this._overlay.find(".dialog > .content"),m.apply(this),this._states.run("cover"),g.apply(this),this._slider.render(this.el.find(".bd .guide .preview > ol"),this.el.find(".bd .guide .help > ol")),this._overlay.appendTo(this._container),this},l.prototype.start=function(){h.apply(this._overlay);var e=i.getDevice();return y.call(this,e),e.length?this._states.handleEvent("continue"):o.event("push_tutorial:cover:enter"),this._stayTimestamp=(new Date).getTime(),this._cacheDevicesAmount=e.length,this},l.prototype.stop=function(){this._states.handleEvent("stop")};var c=function(){var e=$(document.body);$(this).offset({left:0,top:0}).find("mask").width(e.width()).height(Math.max(e.height(),$(window).height())).end().find(".dialog").offset(d)},h=function(){var e=$(document),t=$(this);t.appendTo(document.body),t.show(),c.apply(t),this._repositionInterval=setInterval(function(){var e=$(document.body);t.offset({left:0,top:0}).find(".mask").width(e.width()).height(Math.max(e.height(),$(window).height()))},500)},p=function(){$(this).hide(),clearInterval(this._repositionInterval),this._repositionInterval=null},d=function(){var e=$(this),t=$(window);return{left:Math.max(0,t.width()-e.outerWidth())/2+t.scrollLeft(),top:Math.max(0,t.height()-e.outerHeight())/2+t.scrollTop()}},v=function(){var e=new n(this);return e.addEntryFunction({state:"cover",entry:function(){this.el.find(".bd > .cover, .ft > .later, .ft > .continue").show()}}),e.addExitFunction({state:"cover",exit:function(){this.el.find(".bd > .cover, .ft > .later, .ft > .continue").hide()}}),e.addActionTransition({state:"cover",event:"continue",transition:"@guide"}),e.addActionTransition({state:"cover",event:"update",transition:"@cover"}),e.addActionTransition({state:"cover",event:"cancel",transition:function(){return u.set(t.user.IGNORE_NODEVICE,"1",{path:"/",domain:"www.wandoujia.com"}),this._states.doActionTransition("cover","stop")}}),e.addActionTransition({state:"cover",event:"stop",transition:function(){p.apply(this._overlay);var e=(new Date).getTime();return o.event("push_tutorial:stay:stay:"+Math.floor((e-this._stayTimestamp)/1e3)),"cover"}}),e.addEntryFunction({state:"guide",entry:function(){var e=!!i.getDevice().length;this.el.find(".bd > .guide").show().end().find(".ft > .waiting").toggle(!e).end().find(".ft > .finish").toggle(e).end().find(".bd .guide .account").text(SnapPea.Account.getUserInfo().nick),this._slider.start()}}),e.addExitFunction({state:"guide",exit:function(){this.el.find(".bd > .guide, .ft > .waiting, .ft > .finish").hide(),this._slider.stop()}}),e.addActionTransition({state:"guide",event:"continue",transition:"=stop@guide"}),e.addActionTransition({state:"guide",event:"update",transition:function(){var e=!!i.getDevice().length;return this.el.find(".ft > .waiting").toggle(!e).end().find(".ft > .finish").toggle(e),"guide"}}),e.addActionTransition({state:"guide",event:"stop",transition:"=stop@cover"}),e},m=function(){var e=this._overlay,t=this._states;this._overlay.delegate(".dialog > .close","click",function(e){t.handleEvent("stop")}).delegate(".ft > .later","click",function(){t.handleEvent("cancel")}).delegate(".ft > .continue","click",function(){t.handleEvent("continue")}).delegate(".ft > .finish","click",function(){t.handleEvent("continue")}),$(window).resize(this._overlay,function(e){var t=e.data;t.is(":visible")&&c.apply(t)})},g=function(){var e=this;i.subscribe("update",function(t){y.apply(e,[t]),e._overlay.is(":visible")&&t.length>e._cacheDevicesAmount&&(o.event("push_tutorial:device_connected"),e._cacheDevicesAmount=t.length)}),this._devicesList.subscribe("update",function(){e._devicesList.blink(),e._states.handleEvent("update")})},y=function(e){var t=this.el.find(".devices");t[0].innerHTML="",e.length?this._devicesList.render(t):t.html('<span style="color:#888;">没有已连接的设备。</div>')},b=function(){var e,t,n,r=4,i=0,s=!1,o=function(){t.on("click mouseenter","li",function(e){u(t.find("li").index(this)),s=!0}).on("mouseleave","li",function(e){s=!1})},u=function(n){n%=r,t.find("li").removeClass("current").eq(n).addClass("current"),e.attr("class","").addClass("step-"+(n+1)),i=n};return{render:function(n,r){e=n,t=r,o()},start:function(){if(n)return;s=!1,u(0),n=setInterval(function(){if(s)return;u(i+1)},1e4)},stop:function(){clearInterval(n),n=null}}};return l}),DeviceCenterWidget.define("data/messagepublisher",["config","lib/event/eventproxy"],function(e,t){var n=function(){this._pendingRequest=null,this._requestTimer=null,this._cacheDevicesList=[],this._cacheDevicesHash={},t.attachTo(this)};n.prototype.run=function(){if(this.isRunning())return;var e=this;(function(){e._pendingRequest=r(e),e._requestTimer=setTimeout(arguments.callee,5e3)})()},n.prototype.stop=function(){this._requestTimer&&(clearTimeout(this._requestTimer),this._requestTimer=null),this._pendingRequest&&(this._pendingRequest.abort(),this._pendingRequest=null),this._cacheDevicesList=[]},n.prototype.isRunning=function(){return!!this._requestTimer};var r=function(t){return $.ajax({dataType:"jsonp",url:e.service.ONLINE_URL,timeout:4e3,success:function(e){t.publish("online",e)}})};return n}),DeviceCenterWidget.define("data/signscanner",["lib/event/eventproxy","config","data/cookie"],function(e,t,n){var r=function(){e.attachTo(this),this._scanner=null};r.prototype.isSignIn=function(){return i(n.get(t.user.SIGNIN_COOKIE))},r.prototype.start=function(){if(this._scanner)return;var e=this.isSignIn(),t=this;this._scanner=setInterval(function(){var n=t.isSignIn();n!==e&&(e=n,t.publish(e?"signin":"signout"))},1e3),t.publish(e?"ready":"welcome")},r.prototype.stop=function(){this._scanner&&(clearInterval(this._scanner),this._scanner=null)};var i=function(e){return e!==void 0};return r}),DeviceCenterWidget.define("data/pushscanner",["lib/event/eventproxy","config","data/user"],function(e,t,n){var r=function(){e.attachTo(this),this._timer=null,this._xhr=null};r.prototype.start=function(){var e=this;(function(){i.apply(e),e._timer=setTimeout(arguments.callee,3e4)})()},r.prototype.stop=function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._xhr&&(this._xhr.abort(),this._xhr=null)},r.prototype.update=function(){return this.isRunning()?(i.apply(this),this._xhr.promise()):!1},r.prototype.isRunning=function(){return!!this._timer||!!this._xhr};var i=function(){var e=this,r=n.getCurrentDevice();r&&(e._xhr&&e._xhr.abort(),e._xhr=$.ajax({type:"get",dataType:"json",cache:!1,url:t.service.OFFLINE_LIST_URL,data:{status:0,did:r.dev_id},success:function(t){e.publish("update",t)},error:function(e,t,n){},complete:function(){e._xhr=null}}))};return r}),DeviceCenterWidget.define("service/apppush",["config","lib/event/eventproxy"],function(e,t){var n=function(){this._isRunning=!1,t.attachTo(this)};return n.prototype.run=function(){this._isRunning=!0,this.publish("running")},n.prototype.stop=function(){this._isRunning=!1,this.publish("stop")},n.prototype.isRunning=function(){return this._isRunning},n.prototype.serve=function(t){var n,r,i,s;return s=$.Deferred(),i=t.deviceId,n=t.data,i?($.isArray(n)||(n=[n]),r=$.map(n,function(e){return'{"u":"'+e.url+'", "n":"'+e.name+'"}'}),r="["+r.join(",")+"]",$.ajax({dataType:"jsonp",url:e.service.APPPUSH_URL,data:{did:i,d:r},success:function(e){s.resolve(e.msg)},error:function(){s.reject("network error")}}),s.promise()):s.reject("valid device id").promise()},n}),DeviceCenterWidget.define("service/offlinepush",["config","lib/event/eventproxy"],function(e,t){var n=function(){this._isRunning=!1,t.attachTo(this)};return n.prototype.run=function(){this._isRunning=!0,this.publish("running")},n.prototype.stop=function(){this._isRunning=!1,this.publish("stop")},n.prototype.isRunning=function(){return this._isRunning},n.prototype.serve=function(t){var n,r,i,s;return s=$.Deferred(),i=t.deviceId,n=t.data,i?($.ajax({dataType:"json",type:"post",url:e.service.OFFLINE_PUSH_URL,data:{did:i,title:n.name,url:n.url,versioncode:n.versionCode,packagename:n.packageName},success:function(e){if(e.error===1)s.reject("server fatal");else{var t=e.error===2?!1:!0,n=e.data.length,r=e.data;s.resolve({support:t,count:n,data:r})}},error:function(){s.reject("network error")}}),s.promise()):s.reject("valid device id").promise()},n}),DeviceCenterWidget.define("service/servicesfactory",["service/apppush","service/offlinepush"],function(e,t){var n=function(){this._services={}};return n.prototype.service=function(e,t){var n=this._getService(e);return n.serve(t)},n.prototype._getService=function(n){var r,i;if(this._services[n])return this._services[n];switch(n){case"apppush":r=e;break;case"offlinepush":r=t;break;default:return null}return i=new r,i.run(),this._services[n]=i},new n}),DeviceCenterWidget.define("devicecenter",["lib/event/eventproxy","lib/states/statesmachine","config","util","view/v2/widget","view/notifier","view/v2/guide","data/user","data/messagepublisher","data/signscanner","data/pushscanner","service/servicesfactory","view/deviceslist","data/ga","data/cookie","tpl/nls/root/widget"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=function(){e.attachTo(this),this._container=null,this._services={},this.view=null,this.notifier=null,this.guide=null,this._user=u,this._messagePublisher=new a,this._signScanner=new f,this._pushScanner=new l,this._tipBlocker=null,this._currentDeviceId=null};return m.prototype.render=function(e){this._container=e||".devicecenter-container",this.view=new i(this._container),this.notifier=new s,this.notifier.render({reference:this._container}),this.guide=new o,this.guide.render(),this._bindEvents()},m.prototype.currentDeviceOnline=function(){return this._user.isDeviceOnline(this._currentDeviceId)},m.prototype.pushService=function(e){var t=this;if(!this._user.getCurrentDevice()){this.guide.start(),e.error&&e.error.call(t,"nodevice");return}$.when(1).then(function(){var n={deviceId:t._currentDeviceId,data:e.data},i="offlinepush";$.when(c.service(i,n)).then(function(n){e.success&&e.success.call(t,n);if(!e.silent)if(t._user.isDeviceOnline(t._user.getCurrentDevice().dev_id))$.each($.isArray(e.data)?e.data:[e.data],function(e,n){t.notifier.publishTip({message:r.format(v.onlinePushNotice,n.name||"")})});else{var i=$.map(n.data,function(e){return e.n});i=i.join(","),t.notifier.publishOfflinePushTip({num:n.count,apps:i,"support?":n.support})}t.view.togglePushIndicator(!!n.data)}).fail(function(n){e.error&&e.error.call(t,n),e.silent||i==="apppush"&&$.each($.isArray(e.data)?e.data:[e.data],function(e,n){t.notifier.publishTip({message:n.name+" 发送失败"})})})})},m.prototype._bindEvents=function(){var e=this._user,t=this._messagePublisher,i=this._signScanner,s=this._pushScanner,o=this.view,u=this.notifier,a=this.guide,f=this;i.subscribe("ready",function(){e.run(),f._tipBlocker=setTimeout(function(){f._tipBlocker=null},5e3),o.render("frame"),p.event("dev_widget:load:logged_in")}),i.subscribe("welcome",function(){o.render("signin"),p.event("dev_widget:load:visitor")}),i.subscribe("signin",function(){r.refreshWindow();return}),i.subscribe("signout",function(){r.refreshWindow();return}),t.subscribe("online",function(t){e.setOnlineDevicesList(t)}),e.subscribe("init",function(e){p.identifyUser(SnapPea.Account.getUserInfo().uid),t.run(),s.start(),!e.length&&!d.get(n.user.IGNORE_NODEVICE)&&a.start()}),e.subscribe("update",function(e){}),e.subscribe("change",function(e){f._currentDeviceId=e.dev_id,o.togglePushIndicator(!1),s.update(),f.publish("current:change",e)}),e.subscribe("online",function(t){f._tipBlocker||u.publishTip({message:e.getDevice(t).model+" 已连接"}),p.event("dev_widget:device:connect"),f.publish("device:online"),t===f._currentDeviceId&&f.publish("current:online")}),e.subscribe("offline",function(t){f._tipBlocker||u.publishTip({message:e.getDevice(t).model+" 断开"}),p.event("dev_widget:device:disconnect"),f.publish("device:offline"),t===f._currentDeviceId&&f.publish("current:offline")}),o.subscribe("change",function(t){f._currentDeviceId=t,e.setCurrentDevice(t)}),o.subscribe("guide",function(){a.start()}),o.subscribe("pushlist",function(){$.when(s.update()).then(function(e){if(e.error===1||!e.data.length)return;var t=$.map(e.data,function(e){return e.n});t=t.join(","),f.notifier.publishOfflinePushTip({num:e.data.length,apps:t,"support?":e.error!==2})})}),s.subscribe("update",function(e){o.togglePushIndicator(e.error!==1&&!!e.data.length)})},new m}),DeviceCenterWidget.define("devicecenter_production",function(){});